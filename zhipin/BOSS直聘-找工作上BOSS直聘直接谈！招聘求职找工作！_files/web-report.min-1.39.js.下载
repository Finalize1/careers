"use strict";function _construct(e,t,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"function"==typeof require&&"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=performanceReport:window.performanceReport=performanceReport;var customReport,customSendDataToAPm,customReportData,APMSDKVERSION="1.39",CustomReportDataFn=function(){function n(e,t,r){_classCallCheck(this,n),this.data=e,this.networkerror=t,this.subtype=r,this.customItems=[]}return _createClass(n,[{key:"getCustomData",value:function(){if("string"!=typeof this.data){var e=void 0===this.data?{}:this.data,t=void 0===this.networkerror?"action_js_monitor":this.networkerror,r=void 0===this.subtype?"diyError":this.subtype,n=customReport(4,t,r),o=_objectSpread(_objectSpread({},e),{name:"customReport"});return n.p7=JSON.stringify(o),this.customItems.push(n),this.customItems}}}]),n}();function getTimes(){return(new Date).getTime()}function getQueryParams(e){for(var t={},r=(1<e.split("?").length?e.split("?")[1]:e).split("&"),n=0;n<r.length;n++){var o=r[n].split("=");1<o.length&&(t[o[0]]=o[1])}return t}function randomString(e){e=e||10;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz123456789",r=t.length,n="",o=0;o<e;o++)n+=t.charAt(Math.floor(Math.random()*r));return n+getTimes()}function performanceReport(e,h){try{var r=function(e){var p={appKey:T.appKey||"7O9U1uHCgZ8r0DK7",bucketSize:l.bucketSize||10,timeSlice:l.timeSlice||60,epochMillis:getTimes(),data:[]};function f(e){if(0<=(e=Number(e))&&e<=10)return 0;if(10<e&&e<=50)return 10;if(50<e&&e<=100)return 50;if(100<e&&e<=200)return 100;if(200<e&&e<=500)return 200;if(500<e&&e<=1e3)return 500;if(1e3<e&&e<=2e3)return 1e3;if(2e3<e&&e<=4e3)return 2e3;if(4e3<e&&e<=8e3)return 4e3;if(8e3<e)return 8e3;throw new Error("无效时间差")}function d(e){if(0==(e=Number(e)))return 0;if(200==e)return 200;if(300<=e&&e<400)return 300;if(400<=e&&e<500)return 404;if(500==e)return 500;if(502==e)return 502;if(503==e)return 503;throw new Error("无效code")}e?function(e){for(var t=window.location.host,r=[],n="",o={metrics:[]},i={uri:"",respTimeBuckets:[],respCodeBuckets:[]},a=L.requestList.length,s={},c=0,u=0;u<a;u++)s=L.requestList[u].data,i.uri=s.requestUrl,i.respTimeBuckets=[f(s.ajaxTime),1],i.respCodeBuckets=[d(s.status),1],n=s.host||t,o.metrics.push(i),r.includes(n)||(r.push(n),p.data.push({host:n,metrics:[]})),c=r.indexOf(n),p.data[c].host=n,p.data[c].metrics.push(i),n="",i={},s={};e()}(function(){0<p.data.length&&setTimeout(t(p,function(e){}),500)}):function(){}()},t=function(e,t){fetch(j+"/wapi/zpApm/httpMetrics/report",{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8","report-source":"apmsdk-fetch-v"+APMSDKVERSION},mode:"cors",credentials:"include",type:"report-data",body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){"function"==typeof t&&0===e.code&&t(e)}).catch(function(e){})},m=function(){var e=new Date,t=localStorage.getItem("bs_markUv")||"",r=localStorage.getItem("bs_markUvTime")||"",n=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" 23:59:59";return(!t&&!r||e.getTime()>1*r)&&(t=randomString(),localStorage.setItem("bs_markUv",t),localStorage.setItem("bs_markUvTime",new Date(n).getTime())),t},g=function(e){var t=navigator.userAgent.toLowerCase()||e.toLowerCase(),r=null,n=-1<t.indexOf("trident"),o=-1<t.indexOf("safari"),i=-1<t.indexOf("chrome"),a=-1<t.indexOf("bosszhipin"),s=-1<t.indexOf("iphone"),c=-1<t.indexOf("android"),u=-1<t.indexOf("qqbrowser"),p=-1<t.indexOf("tbs"),f=-1<t.indexOf("micromessenger"),d=-1<t.indexOf("miniprogram"),l=-1<t.indexOf("baidu"),h=-1<t.indexOf("qhbrowser"),m=-1<t.indexOf("sogou"),g=-1<t.indexOf("lbbrowser"),y=-1<t.indexOf("ucbrowser"),v={IE:window.ActiveXObject||"ActiveXObject"in window||n,Chrome:i&&o,Firefox:-1<t.indexOf("firefox"),Opera:-1<t.indexOf("opera"),Safari:o&&-1==t.indexOf("chrome"),WKwebview:s&&a,webview:c&&i&&o,Edge:-1<t.indexOf("edge"),QQBrowser:u&&!a&&!m,WeixinBrowser:f||d,X5:c&&a&&u&&p,Baidu:l,QiHu360:h,SoGou:u&&m,LieBao:g,UC:y};for(var S in v)v[S]&&(r=S);return r},y=function(){var e="",t={},r=navigator.userAgent.toLowerCase();for(var n in t.Windows="Win32"==navigator.platform||"Windows"==navigator.platform,t.Mac="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform,t.iOS=-1<r.indexOf("iphone")||-1<r.indexOf("ipad")||-1<r.indexOf("ipod"),t.android=-1<r.indexOf("android"),t.harmony=-1<r.indexOf("harmony"),t.openHarmony=-1<r.indexOf("openharmony"),t)t[n]&&(e=n);return e},v=function(e){var t=(e||navigator.userAgent).toLowerCase(),r=0,n=t.match(/android (\d+(\.\d+)?)/),o=t.match(/(iphone|ipad|ipod).*os (\d+_?\d+(_\d+)?)/),i=t.match(/harmonyos (\d+(\.\d+)?)/),a=t.match(/openharmony (\d+(\.\d+)?)/),s=t.match(/macintosh.*mac os x (\d+_\d+(_\d+)?)/);return n?r=parseFloat(n[1]):o?r=parseFloat(o[2].replace(/_/g,".")):i?r=parseFloat(i[1]):a?r=parseFloat(a[1]):s&&(r=parseFloat(s[1].replace(/_/g,"."))),r},S=function(e){if("/"==e)return"/";var t=e.indexOf("undefined")||-1;return(e=0<t?e.substring(0,t+9):e).match(/(\/)?([a-zA-Z-_0-9~])+(\/)?/g).map(function(e){return e=18<=e.length&&/\d{6,}([A-Z]+)?[a-z]+/.test(e.split("/")[0].split("").filter(function(e){return/\d|[A-Z]|[a-z]/.test(e)}).sort().join(""))?"encryptedString/":e}).join("")},w=function(e){var t=location.origin?location.origin:location.protocol+"//"+location.hostname,r=t.length;return e.includes("?")?e.substring(r).split("?")[0]:e.includes("&")?e.substring(r).split("&")[0]:e.includes(t)?e.substring(r):e},x=function(e){return e<=2?"action_js_performance":3==e?"action_js_monitor":4==e?T.action||"action_js_monitor":5==e?"action_blankScreen":"action_js_monitor"},c=function(e,t,r,n){var o=0<arguments.length&&void 0!==e?e:1,i=1<arguments.length?t:void 0,a=2<arguments.length?r:void 0,s=3<arguments.length?n:void 0;void 0===s&&3==o&&(s=L.errorList.length);var c=function(){var e=sessionStorage.getItem("bs_markUser")||"",t={markUser:e,isFristIn:!1};return e||(e=randomString(),sessionStorage.setItem("bs_markUser",e),t.markUser=e,t.isFristIn=!0),t}(),u=location.href;if(0<document.querySelector("body").attributes.length){var p=document.querySelector("body").attributes.getNamedItem("data-pv");p&&""!=p.nodeValue&&(u=p.nodeValue||p.value||p.textContent)}var f={time:getTimes(),markUser:c.markUser,type:o,url:u,pv:S(w(u)),markUv:m()};if(function(){var e=L.resourceList,t=T.filterUrl,r=[];if(e&&e.length&&t&&t.length)for(var n=0;n<e.length;n++){for(var o=!1,i=0;i<t.length;i++)if(-1<e[n].name.indexOf(t[i])){o=!0;break}o||r.push(e[n])}L.resourceList=r}(),1===o)T.isPerformance&&O(),(T.isResource||T.isAjax)&&b(),f=Object.assign(f,{preUrl:L.preUrl,performance:L.performance,resourceList:L.resourceList,requestList:L.requestList,isFristIn:c.isFristIn});else if(2===o)f=Object.assign(f,{requestList:L.requestList});else if(3===o){var d=0<L.errorList.length?L.errorList[s-1].msg:"";f=Object.assign(f,{errorList:L.errorList,errorSig:function(e){function s(e,t){return e<<t|e>>>32-t}function c(e,t){var r,n,o,i,a;return o=2147483648&e,i=2147483648&t,a=(1073741823&e)+(1073741823&t),(r=1073741824&e)&(n=1073741824&t)?2147483648^a^o^i:r|n?1073741824&a?3221225472^a^o^i:1073741824^a^o^i:a^o^i}function t(e,t,r,n,o,i,a){return c(s(e=c(e,c(c(function(e,t,r){return e&t|~e&r}(t,r,n),o),a)),i),t)}function r(e,t,r,n,o,i,a){return c(s(e=c(e,c(c(function(e,t,r){return e&r|t&~r}(t,r,n),o),a)),i),t)}function n(e,t,r,n,o,i,a){return c(s(e=c(e,c(c(function(e,t,r){return e^t^r}(t,r,n),o),a)),i),t)}function o(e,t,r,n,o,i,a){return c(s(e=c(e,c(c(function(e,t,r){return t^(e|~r)}(t,r,n),o),a)),i),t)}function i(e){var t,r="",n="";for(t=0;t<=3;t++)r+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return r}var a,u,p,f,d,l,h,m,g,y;for(y=function(e){for(var t,r=e.length,n=r+8,o=16*(1+(n-n%64)/64),i=new Array(o-1),a=0,s=0;s<r;)a=s%4*8,i[t=(s-s%4)/4]=i[t]|e.charCodeAt(s)<<a,s++;return a=s%4*8,i[t=(s-s%4)/4]=i[t]|128<<a,i[o-2]=r<<3,i[o-1]=r>>>29,i}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t}(e)),l=1732584193,h=4023233417,m=2562383102,g=271733878,a=0;a<y.length;a+=16)h=o(h=o(h=o(h=o(h=n(h=n(h=n(h=n(h=r(h=r(h=r(h=r(h=t(h=t(h=t(h=t(p=h,m=t(f=m,g=t(d=g,l=t(u=l,h,m,g,y[a+0],7,3614090360),h,m,y[a+1],12,3905402710),l,h,y[a+2],17,606105819),g,l,y[a+3],22,3250441966),m=t(m,g=t(g,l=t(l,h,m,g,y[a+4],7,4118548399),h,m,y[a+5],12,1200080426),l,h,y[a+6],17,2821735955),g,l,y[a+7],22,4249261313),m=t(m,g=t(g,l=t(l,h,m,g,y[a+8],7,1770035416),h,m,y[a+9],12,2336552879),l,h,y[a+10],17,4294925233),g,l,y[a+11],22,2304563134),m=t(m,g=t(g,l=t(l,h,m,g,y[a+12],7,1804603682),h,m,y[a+13],12,4254626195),l,h,y[a+14],17,2792965006),g,l,y[a+15],22,1236535329),m=r(m,g=r(g,l=r(l,h,m,g,y[a+1],5,4129170786),h,m,y[a+6],9,3225465664),l,h,y[a+11],14,643717713),g,l,y[a+0],20,3921069994),m=r(m,g=r(g,l=r(l,h,m,g,y[a+5],5,3593408605),h,m,y[a+10],9,38016083),l,h,y[a+15],14,3634488961),g,l,y[a+4],20,3889429448),m=r(m,g=r(g,l=r(l,h,m,g,y[a+9],5,568446438),h,m,y[a+14],9,3275163606),l,h,y[a+3],14,4107603335),g,l,y[a+8],20,1163531501),m=r(m,g=r(g,l=r(l,h,m,g,y[a+13],5,2850285829),h,m,y[a+2],9,4243563512),l,h,y[a+7],14,1735328473),g,l,y[a+12],20,2368359562),m=n(m,g=n(g,l=n(l,h,m,g,y[a+5],4,4294588738),h,m,y[a+8],11,2272392833),l,h,y[a+11],16,1839030562),g,l,y[a+14],23,4259657740),m=n(m,g=n(g,l=n(l,h,m,g,y[a+1],4,2763975236),h,m,y[a+4],11,1272893353),l,h,y[a+7],16,4139469664),g,l,y[a+10],23,3200236656),m=n(m,g=n(g,l=n(l,h,m,g,y[a+13],4,681279174),h,m,y[a+0],11,3936430074),l,h,y[a+3],16,3572445317),g,l,y[a+6],23,76029189),m=n(m,g=n(g,l=n(l,h,m,g,y[a+9],4,3654602809),h,m,y[a+12],11,3873151461),l,h,y[a+15],16,530742520),g,l,y[a+2],23,3299628645),m=o(m,g=o(g,l=o(l,h,m,g,y[a+0],6,4096336452),h,m,y[a+7],10,1126891415),l,h,y[a+14],15,2878612391),g,l,y[a+5],21,4237533241),m=o(m,g=o(g,l=o(l,h,m,g,y[a+12],6,1700485571),h,m,y[a+3],10,2399980690),l,h,y[a+10],15,4293915773),g,l,y[a+1],21,2240044497),m=o(m,g=o(g,l=o(l,h,m,g,y[a+8],6,1873313359),h,m,y[a+15],10,4264355552),l,h,y[a+6],15,2734768916),g,l,y[a+13],21,1309151649),m=o(m,g=o(g,l=o(l,h,m,g,y[a+4],6,4149444226),h,m,y[a+11],10,3174756917),l,h,y[a+2],15,718787259),g,l,y[a+9],21,3951481745),l=c(l,u),h=c(h,p),m=c(m,f),g=c(g,d);return(i(l)+i(h)+i(m)+i(g)).toLowerCase()}(d+f.pv)})}else 4===o&&i&&(T.action=i+"");f=Object.assign(f,T.add),h&&h(f);var l={action:x(o),p:JSON.stringify({appKey:T.appKey,time:f.time,type:function(e,t,r){var n="";if(2<e){n=t.errorList&&0<t.errorList.length?t.errorList[0].data.status||t.errorList[0].n:"otherError";for(var o=[500,400,300,200,100],i=["50X","40X","30X","20X","10x"],a=0;a<o.length;a++)o[a]<=n&&(n=i[a]);n=r&&""!=r?r:n}return n}(o,f,a),pv:f.pv,uv:f.markUv,from:"apmsdk",errorSig:f.errorSig||""}),p2:JSON.stringify({url:f.url}),p3:o<=2?JSON.stringify(f.requestList):3===o?JSON.stringify([f.errorList[s-1]]):"",p4:f.performance?JSON.stringify(f.performance):"",p5:f.resourceList?JSON.stringify(f.resourceList):"",p6:JSON.stringify({os:y(),browser:g(),version:v(navigator.userAgent)})};if(o&&o<=2)U.push(l);else if(3===o&&C.push(l),4===o)return l},n=function(e,t){var r=window.screen.width,n=window.screen.height,o={identity:1,clientInfo:{os:y(),model:navigator.userAgent,screen:JSON.stringify({width:r,height:n}),version:v(navigator.userAgent)},items:e};!h&&window.fetch?fetch(T.domain,{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8","report-source":"apmsdk-fetch-v"+APMSDKVERSION},mode:"cors",credentials:"include",type:"report-data",body:JSON.stringify(o)}).then(function(e){return e.json()}).then(function(e){"function"==typeof t&&0===e.code&&t()}).catch(function(e){}):p({url:T.domain,type:"POST",async:!0,data:JSON.stringify(o),dataType:"json",success:function(e){"function"==typeof t&&0===e.code&&t()}})},o=function(e,t,r){var n={n:"request"};n.t=getTimes(),n.msg="request performance",n.data={host:function(e){var t=e.xhr.responseURL,r="";return"function"==typeof URL&&(""==t&&(t=e.args.url),r=0==t.indexOf("http")?new URL(t).host:t),r}(e),method:e.args.method,type:e.args.type,requestUrl:e.args.url,status:e.xhr.status},L.haveAjax&&L.haveFetch&&t&&r?(n.data.ajaxTime=t,n.data.fetchTime=r,L.requestList.push(n)):L.haveAjax&&!L.haveFetch&&t?(n.data.ajaxTime=t,L.requestList.push(n)):!L.haveAjax&&L.haveFetch&&r&&(n.data.fetchTime=r,L.requestList.push(n))},O=function(){if(window.performance){var e=performance.timing,t=performance.memory;L.performance={dnst:e.domainLookupEnd-e.domainLookupStart||0,tcpt:e.connectEnd-e.connectStart||0,sslt:e.connectEnd-e.secureConnectionStart||0,ttfb:e.responseStart-e.requestStart||0,datadlt:e.responseEnd-e.responseStart||0,reqt:e.responseEnd-e.requestStart||0,andt:e.domComplete-e.domInteractive||0,tti:e.domInteractive-e.fetchStart||0,sourcest:e.loadEventStart-e.domContentLoadedEventEnd||0,wit:e.responseStart-e.navigationStart||0,domt:e.domContentLoadedEventEnd-e.navigationStart||0,lodt:e.loadEventEnd-e.navigationStart||0,radt:e.fetchStart-e.navigationStart||0,rdit:e.redirectEnd-e.redirectStart||0,uodt:e.unloadEventEnd-e.unloadEventStart||0,jsHeapSizeLimit:t?t.jsHeapSizeLimit:0,totalJSHeapSize:t?t.totalJSHeapSize:1,usedJSHeapSize:t?t.usedJSHeapSize:0,memoryUsedPercent:((t?t.usedJSHeapSize:0)/(t?t.totalJSHeapSize:1)*100).toFixed(2)+"%"}}},b=function(){if(1<=L.resourceList.length)return!1;if(!window.performance||!window.performance.getEntries)return!1;var e=performance.getEntriesByType("resource"),o=[];if(!e&&!e.length)return o;e.forEach(function(e){if((T.isAjax||"xmlhttprequest"!=e.initiatorType&&"fetch"!=e.initiatorType)&&(T.isResource||"xmlhttprequest"==e.initiatorType||"fetch"===e.initiatorType)){var t={name:e.name,method:"GET",type:e.initiatorType,duration:e.duration.toFixed(2)||0,decodedBodySize:e.decodedBodySize||0,nextHopProtocol:e.nextHopProtocol},r=e.name?e.name.split("?")[0]:"",n=L.ajaxMsg[r]||"";n&&(t.method=n.method||"GET",t.type=n.type||t.type,t.decodedBodySize=t.decodedBodySize||n.decodedBodySize),o.push(t)}}),L.resourceList=o},i=function(e){var t={method:"GET",type:"fetchrequest"},r=Array.prototype.slice.apply(e);if(!r||!r.length)return t;try{1===r.length?"string"==typeof r[0]?t.url=r[0]:"object"===_typeof(r[0])&&(t.url=r[0].url,t.method=r[0].method):(t.url=r[0],t.method=r[1].method||"GET",t.type=r[1].type||"fetchrequest")}catch(e){}return t},a=function(e,t){var r=Object.assign({},d);r.n=e.args?e.args.type:"ajax",r.t=getTimes(),r.data={resourceUrl:e.args?e.args.url:e.xhr.responseURL,requestParams:/\?/.test(e.xhr.responseURL)?e.xhr.responseURL.split("?")[1]:e.xhr.responseURL,status:e.xhr.status},r.method=e.args.method;try{var n=e.xhr.responseText&&JSON.parse(e.xhr.responseText)}catch(e){}if(void 0!==n&&!(0==n.c&&0<=n.d)){0<n.code&&n.message?(r.code=n.code,r.msg=n.message||"ajax response error",r.zpData=n.zpData):0<n.errcode&&n.errmsg?(r.code=n.errcode,r.msg=n.errmsg,r.zpData=n.data):r.res=n;var o=L.errorList.push(r);c(3,T.action,"responseError",o)}},s=function(e){L.fetchNum+=1,L.fetLength===L.fetchNum&&(type,L.fetchNum=L.fetLength=0,N=getTimes()-E,o(xhr,_,N))},u=function(e,t){L.loadNum=L.loadNum+1;var r=getTimes();o(t,_=r-P,N)},p=function(t){var e,r=null,n=!0;(!1===t.async&&(n=!1),window.XMLHttpRequest&&(r=new XMLHttpRequest),"GET"==t.type.toUpperCase())?(t.data&&(e=function(e){var t=[];for(var r in e)t.push(r+"="+e[r]);return t.join("&")}(t.data)),e?r.open(t.type,t.url+"?"+e,t.async):r.open(t.type,t.url,t.async),r.send()):"POST"==t.type.toUpperCase()&&(r.open(t.type,t.url,n),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.setRequestHeader("report-source","apmsdk-ajax-v"+APMSDKVERSION),r.withCredentials=!0,t.data?r.send(t.data):r.send());r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=r.responseText;"JSON"===t.dataType.toUpperCase()?t.success(JSON.parse(e)):t.success(e)}}},f=function(e){var t=0<arguments.length&&void 0!==e?e:0;window.performance&&window.performance.clearResourceTimings&&performance.clearResourceTimings(),C=[],L.performance={},L.errorList=[],L.requestList=[],L.preUrl="",L.resourceList=[],L.page=0===t?location.href:"",L.haveAjax=!1,L.haveFetch=!1,L.loadNum=L.ajaxLength=0,L.ajaxMsg={},ADDDATA={},N=_=0},d={n:"js",t:"",msg:"",data:{}},l={bucketSize:10,timeSlice:60,reportPeriod:60},j=window.location.hostname.endsWith(".zhipin.com")?"https://apm-fe.zhipin.com":"https://apm-fe-qa.weizhipin.com",T={userIdUrl:"",domain:j+"/wapi/zpApm/actionLog/fe/common.json",appKey:"7O9U1uHCgZ8r0DK7",action:"action_js_monitor",outtime:3e3,filterUrl:[],isPerformance:!0,isAjax:!0,isFetch:!1,isResource:!0,isKAjs:!0,isError:!0,isResponseCode:!0,multipleReports:!1,isBlankScreen:!0,isSkeleton:!1,rootElements:["#root","#wrap","#app"],isMetricsSwitch:!0,add:{}};(T=Object.assign(T,e)).filterUrl=T.filterUrl.concat(["/api/v1/report/web","/wapi/zpCommon/actionLog","/prod-api/boss/log","/sockjs-node/info","/netinfo","/sigverif"]);var L={resourceList:[],performance:{},errorList:[],requestList:[],fetchNum:0,loadNum:0,ajaxLength:0,fetLength:0,ajaxMsg:{},goingType:"",haveAjax:!1,haveFetch:!1,preUrl:document.referrer&&document.referrer!==location.href?document.referrer:"",page:""},E=window.performance.timing.navigationStart||getTimes(),k=0,_=0,P=window.performance.timing.requestStart||getTimes(),N=0,C=[],U=[],R=[];T.isError&&function(){function a(e){var t,r,n,o=e.split("\n");if(1<o.length){var i="",a="";(-1<(i=null==(a=""==o[1]||-1<o[1].indexOf("@[native code]")?o[0]:o[1]).match(/\(?http.+\)?/)?"":a.match(/\(?http.+\)?/)[0]).indexOf("(")||-1<i.indexOf(")"))&&(i=i.replace(/\(/,"").replace(/\)/,""));var s=i.replace(/\w.+[js|html]/g,function(e){return t=e,""}).split(":");r=1<s.length?(n=parseInt(s[1]||0),parseInt(s[2]||0)):(t="",n=0)}return{resourceUrl:t,line:n,col:r}}window.addEventListener("error",function(e){var t="resourceError",r=Object.assign({},d);if(r.n="resource",r.t=getTimes(),r.msg=e.target.localName+" is load error",r.data={target:e.target.localName,type:e.type,classNmae:e.target.className||"",resourceUrl:e.target.href||e.target.currentSrc||e.target.src||"unknown path: "+e.target.className},window.location.href!=r.data.resourceUrl&&(t="404",e.target!=window)){var n=L.errorList.push(r);c(3,T.action,t,n)}},!0),window.onerror=function(t,r,n,o,i){var a=Object.assign({},d);if("Script error."==t&&!r)return!0;setTimeout(function(){o=o||window.event&&window.event.errorCharacter||0,i&&i.stack&&(a.msg=t||i.stack.toString()),a.data={resourceUrl:r,line:n,col:o},a.t=getTimes();var e=L.errorList.push(a);c(3,T.action,"jsError",e)},0)},window.addEventListener("unhandledrejection",function(e){var t=e&&e.reason,r=t.message||"",n=t.stack||"",o=Object.assign({},d);o.msg=r,o.type=e.type,o.stack=n,o.t=getTimes(),o.data=a(n);var i=L.errorList.push(o);L.page!==location.href||L.haveAjax||c(3,T.action,"promiseError",i)});var t=/^\s*at\s.*(\(\S+\)|\(native\))/gm,s={parse:function(e){if(e.stack&&e.stack.match(t))return this.parseV8(e);if(e.stack)return this.parseNitro(e);throw new Error("Cannot parse vue sync error")},parseV8:function(e){var t=e.stack.split("\n");if(t&&1<t.length){var r=t[1],n=r.replace(/^\s+/,"").match(/^at\s(.*)\s\(\S+(!\S+\.vue)(\S+):(\d+):(\d+)\)$/);return{n:"vueError",t:getTimes(),msg:t[0]||r.message,data:{resourceUrl:n[2].substring(1),line:n[4],col:n[5],fn:n[1]}}}},parseNitro:function(e){e.stack.split("\n");if(e)return{n:"vueError",t:getTimes(),msg:e.message,data:{resourceUrl:e.stack,line:e.line,col:e.column}}}};window.vueErrorHandler=function(e,t,r){var n=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e),2)),o=s.parse(n),i=L.errorList.push(o);c(3,T.action,"vueError",i)};var i=console.error;console.error=function(e){try{if("function"==typeof window.Vue.config.errorHandler&&-1<e.indexOf("[Vue warn]"))return!1}catch(e){}var t=Object.assign({},d);if(arguments&&0<arguments.length){var r=e;t.msg="[object Object]"==r?e.toString():r.message||r.substring(0,r.indexOf("."));var n=void 0===r.stack?r:r.stack;t.stack=n,t.data=a(n)}t.t=getTimes();var o=L.errorList.push(t);return c(3,T.action,"jsError",o),i.apply(console,arguments)}}();var A=null;window.addEventListener("load",function(){k=getTimes()-E,A=setTimeout(function(){k&&(c(1),T.isMetricsSwitch&&r(1),n(U,function(){U=[],T.multipleReports=!0})),0<C.length&&n(C,function(){ERRORLIST=[],f(),T.multipleReports=!0}),T.isKAjs&&function(){for(var e=document.getElementsByTagName("script"),t=!1,r=0;r<e.length;r++)if(e[r].src&&e[r].getAttribute("src").includes("ka.")){t=!0;break}t||c(3,T.action,"notFindKAjs"),clearTimeout(A)}()},T.outtime)},!1),T.isFetch&&T.isError&&function(){if(window.fetch){var t=fetch;window.fetch=function(){var r=i(arguments);if("report-data"!==r.type){var e=r.url?r.url.split("?")[0]:"";L.ajaxMsg[e]=r,L.fetLength=L.fetLength+1,L.haveFetch=!0}return t.apply(this,arguments).then(function(e){if("report-data"===r.type)return e;try{var t=e.url?e.url.split("?")[0]:"";e.clone().text().then(function(e){L.ajaxMsg[t]&&(L.ajaxMsg[t].decodedBodySize=e.length)})}catch(e){}return s("success"),e}).catch(function(e){if("report-data"!==r.type){s("error");var t=Object.assign({},d);return t.t=getTimes(),t.n="fetch",t.msg="fetch request error",t.method=r.method,t.data={resourceUrl:r.url,text:e.stack||e,status:0},L.errorList.push(t),e}})}}}(),T.isAjax&&T.isError&&(V={onreadystatechange:function(t){if(L.haveAjax&&4===t.readyState){if("load"===L.goingType)return;if(L.goingType="readychange",T.filterUrl&&T.filterUrl.length){var r=!1;if(T.filterUrl.forEach(function(e){t.args&&-1==t.args.url.indexOf(e)||(r=!0)}),r)return;u(0,t)}var e=t.xhr.responseURL?t.xhr.responseURL.split("?")[0]:"";if(L.ajaxMsg[e])try{t.xhr.response instanceof Blob?L.ajaxMsg[e].decodedBodySize=t.xhr.response.size:L.ajaxMsg[e].decodedBodySize=t.xhr.responseText.length}catch(e){}try{var n="arraybuffer"!=t.xhr.responseType&&t.xhr.responseText&&JSON.parse(t.xhr.responseText);T.isResponseCode&&200==t.xhr.status&&n&&0!=n.code&&a(t),T.isResponseCode&&200==t.xhr.status&&n&&n.errcode&&0!=n.errcode&&a(t)}catch(e){}(t.status<200||0==t.status||400<=t.status)&&(t.method=t.args&&t.args.method,a(t))}},onerror:function(e){u(0,e),e.args&&(e.method=e.args.method,e.responseURL=e.args.url,e.statusText="ajax request error",L.ajaxMsg[e.responseURL]&&u(0,e)),a(e)},onload:function(e){if(4===e.readyState){if("readychange"===L.goingType)return;L.goingType="load",u(0,e);var t=e.xhr.responseURL?e.xhr.responseURL.split("?")[0]:"";if(L.ajaxMsg[t])try{e.xhr.response instanceof Blob?L.ajaxMsg[t].decodedBodySize=e.xhr.response.size:L.ajaxMsg[t].decodedBodySize=e.xhr.responseText.length}catch(e){}try{var r="arraybuffer"!=e.xhr.responseType&&e.xhr.responseText&&JSON.parse(e.xhr.responseText);T.isResponseCode&&200==e.xhr.status&&r&&0!=r.code&&a(e),T.isResponseCode&&200==e.xhr.status&&r&&r.errcode&&0!=r.errcode&&a(e)}catch(e){}(e.status<200||0==e.status||400<=e.status)&&(e.method=e.args&&e.args.method,a(e))}},onloadend:function(e){this.onreadystatechange(e)},open:function(t,e){if(T.filterUrl&&T.filterUrl.length){var r=!1;if(T.filterUrl.forEach(function(e){-1!=t[1].indexOf(e)&&(r=!0)}),r)return}var n={url:t[1].split("?")[0],method:t[0]||"GET",type:"xmlhttprequest"};this.args=n,L.ajaxMsg[n.url]=n,L.ajaxLength=L.ajaxLength+1,L.haveAjax=!0}},window._ahrealxhr=window._ahrealxhr||XMLHttpRequest,XMLHttpRequest=function(){for(var e in this.xhr=new window._ahrealxhr,this.xhr){var t="";try{t=_typeof(this.xhr[e])}catch(e){}"function"===t?this[e]=Z(e):Object.defineProperty(this,e,{get:G(e),set:W(e)})}},window._ahrealxhr),X=function(e){var t=e.zpData.result;T.isMetricsSwitch=t.metricsSwitch,T.isMetricsSwitch||r(0),l.bucketSize=t.bucketSize,l.timeSlice=t.timeSlice,l.reportPeriod=t.reportPeriod,t.pathBlacklist,t.hostBlacklist},p({url:j+"/wapi/zpApm/httpMetrics/getConfig",type:"GET",async:!0,data:{appKey:T.appKey},dataType:"json",success:function(e){"function"==typeof X&&0===e.code&&X(e)}}),T.isBlankScreen&&(z=function(e){!function(e){var t={action:x(5),p:JSON.stringify({appKey:T.appKey,time:getTimes(),type:0<C.length?"jsError":"other",pv:S(w(location.href)),uv:m(),from:"apmsdk",errorSig:e.status||""}),p2:JSON.stringify({url:e.url}),p3:JSON.stringify({title:e.title}),p4:e.domScore?JSON.stringify({domScore:e.domScore}):"",p5:e.emptyPoints?JSON.stringify({emptyPoints:e.emptyPoints}):"",p6:JSON.stringify({os:y(),browser:g(),viewPort:e.viewPort})};R.push(t),n(R,function(){R=[]})}(e)},B=T.isSkeleton,F=T.rootElements,J=3,D=0,I=[],H=[],K=["html","body"].concat(F),B?"complete"!=document.readyState&&q():"complete"===document.readyState?q():window.addEventListener("load",function(){setTimeout(q,2e3)})),customReport=c,customSendDataToAPm=n,customReportData=function(){var e=_construct(CustomReportDataFn,Array.prototype.slice.call(arguments)).getCustomData();setTimeout(function(){customSendDataToAPm(e,function(){e=[]})},2e3)}}catch(e){}function M(e){var t=function(e){return e.id?"#"+e.id:e.className?"object"==_typeof(e.className)&&e.className instanceof SVGAnimatedString?e.className.baseVal||e.className.animVal||"":"string"==typeof e.className?"."+e.className.split(" ").filter(function(e){return!!e}).join("."):void 0:e.nodeName.toLowerCase()}(e);return B&&(D?H.push(t):I.push(t)),-1!=K.indexOf(t)}function q(){for(var e=0,t=0,r=(document.getElementsByTagName("body")[0],window.innerWidth),n=window.innerHeight,o=500<r?9:5,i=Math.pow(o,2),a=1;a<=o;a++)for(var s=1;s<=o;s++){var c=r*a/o,u=n*s/o,p=Math.round(c-r/o/2),f=Math.round(u-n/o/2);M(document.elementFromPoint?document.elementFromPoint(p,f):document.elementsFromPoint(p,f)[0])&&(e++,t+=5==o?4:100/81)}if(e==i)return z({status:e==i?"BlankScreenError":"ok",emptyPoints:e,url:location.href,title:document.title,viewPort:r+"X"+n,domScore:Math.round(t)});if(B){if(!D)return function(){if(window._loopTimer)return;window._loopTimer=setInterval(function(){B&&(D++,H=[]),D<=J?q():(clearInterval(window._loopTimer),window._loopTimer=null)},1e3)}();if(J<=D){if(H.join()==I.join())return z({status:"skeletonError",emptyPoints:e,url:location.href,title:document.title,viewPort:r+"X"+n,domScore:Math.round(t)});if(90<=Math.round(t)||i-5<=e)return z({status:"skeletonPartBlankError",emptyPoints:e,url:location.href,title:document.title,viewPort:r+"X"+n,domScore:Math.round(t)})}}else if(90<=Math.round(t)||i-5<=e)return z({status:"partBlankError",emptyPoints:e,url:location.href,title:document.title,viewPort:r+"X"+n,domScore:Math.round(t)})}var z,B,F,J,D,I,H,K,X,V;function G(r){return function(){var e=this.hasOwnProperty(r+"_")?this[r+"_"]:this.xhr[r],t=(V[r]||{}).getter;return t&&t(e,this)||e}}function W(i){return function(t){var e=this.xhr,r=this,n=V[i];if("function"==typeof n)e[i]=function(){V[i](r)||t.apply(e,arguments)};else{var o=(n||{}).setter;t=o&&o(t,r)||t;try{e[i]=t}catch(e){this[i+"_"]=t}}}}function Z(t){return function(){var e=[].slice.call(arguments);if(!V[t]||!V[t].call(this,e,this.xhr))return this.xhr[t].apply(this.xhr,e)}}}