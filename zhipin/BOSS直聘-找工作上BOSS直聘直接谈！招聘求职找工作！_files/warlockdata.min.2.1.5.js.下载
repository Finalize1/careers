!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Warlock=t()}(this,(function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,r);if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==e(r)?r:r+""}function r(e,r,i){return(r=t(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,r,i){return r&&function(e,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,t(n.key),n)}}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(t){return"function"==typeof t||!(!t||"object"!==e(t))&&a(t.listener)}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.slice(t,e.length)===e}),function(){function e(e){1===this.readyState&&(this.start_time=(new Date).getTime());var t=null;"function"==typeof CustomEvent?t=new CustomEvent(e,{detail:this}):((t=document.createEvent("HTMLEvents")).initEvent(e,!0,!0),t.detail=this),window.dispatchEvent(t)}var t=window.XMLHttpRequest;window.XMLHttpRequest=function(){var r=new t;return r.addEventListener("abort",(function(){e.call(this,"ajaxAbort")}),!1),r.addEventListener("error",(function(){e.call(this,"ajaxError")}),!1),r.addEventListener("load",(function(){e.call(this,"ajaxLoad")}),!1),r.addEventListener("loadstart",(function(){e.call(this,"ajaxLoadStart")}),!1),r.addEventListener("progress",(function(){e.call(this,"ajaxProgress")}),!1),r.addEventListener("timeout",(function(){e.call(this,"ajaxTimeout")}),!1),r.addEventListener("loadend",(function(){e.call(this,"ajaxLoadEnd")}),!1),r.addEventListener("readystatechange",(function(){e.call(this,"ajaxReadyStateChange")}),!1),r}}();var o,s=function(){return n((function e(){i(this,e),this._events={}}),[{key:"on",value:function(t,r){if(!t||!r)return!1;if(!a(r))throw new Error("listener must be a function");this._events[t]=this._events[t]||[];var i="object"===e(r);return this._events[t].push(i?r:{listener:r,once:!1}),this}},{key:"once",value:function(e,t){return this.on(e,{listener:t,once:!0})}},{key:"off",value:function(e,t){var r=this._events[e];if(!r)return!1;if("number"==typeof t)r.splice(t,1);else if("function"==typeof t)for(var i=0,n=r.length;i<n;i++)r[i]&&r[i].listener===t&&r.splice(i,1);return this}},{key:"emit",value:function(e,t){var r=this._events[e];if(!r)return!1;for(var i=0;i<r.length;i++){var n=r[i];n&&(n.listener.call(this,t||{}),n.once&&this.off(e,i))}return this}},{key:"prepend",value:function(t,r){if(!t||!r)return!1;if(!a(r))throw new Error("listener must be a function");this._events[t]=this._events[t]||[];var i="object"===e(r);return this._events[t].unshift(i?r:{listener:r,once:!1}),this}},{key:"prependOnce",value:function(e,t){return this.prepend(e,{listener:t,once:!0})}},{key:"removeAllListeners",value:function(e){e&&this._events[e]?this._events[e]=[]:this._events={}}},{key:"listeners",value:function(e){return e&&"string"==typeof e?this._events[e]:this._events}}])}(),u=new s;!function(e){e.LOG="log",e.INFO="info",e.WARN="warn",e.ERROR="error"}(o||(o={}));var l=new(function(){return n((function e(t){i(this,e),Object.defineProperty(this,"logLevel",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"levels",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.logLevel=t,this.levels=["log","info","warn","error"]}),[{key:"canLog",value:function(){return!!(Ge.para.show_log||S.isSupport()&&"true"===sessionStorage.getItem("warlock_jssdk_debug"))}},{key:"printLog",value:function(e,t,r){var i=this.levels.indexOf(this.logLevel);if(this.levels.indexOf(t)>=i){var n=H(new Date),a=this.getMsgPrefix(r);D(e)?console[t]("[".concat(t.toUpperCase(),"] [").concat(n,"] ").concat(a),e):console[t]("[".concat(t.toUpperCase(),"] [").concat(n,"] ").concat(a," ").concat(e))}}},{key:"getMsgPrefix",value:function(e){return e?"".concat(e):""}},{key:"log",value:function(e,t){try{this.canLog()&&this.printLog(e,o.LOG,t)}catch(e){}}},{key:"info",value:function(e,t){try{this.canLog()&&this.printLog(e,o.INFO,t)}catch(e){}}},{key:"warn",value:function(e,t){try{this.canLog()&&this.printLog(e,o.WARN,t)}catch(e){}}},{key:"error",value:function(e,t){try{this.canLog()&&this.printLog(e,o.ERROR,t)}catch(e){}}}])}())(o.LOG),c=Array.prototype.forEach,d=Object.prototype.hasOwnProperty;function f(e,t,r){if(null==e)return!1;if(c&&e.forEach===c)e.forEach(t,r);else if(L(e))for(var i=0,n=e.length;i<n;i++)i in e&&t.call(r,e[i],i,e);else for(var a in e)d.call(e,a)&&t.call(r,e[a],a,e)}function p(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return f(r,(function(t){for(var r in t)d.call(t,r)&&void 0!==t[r]&&(e[r]=t[r])})),e}function h(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return f(r,(function(t){for(var r in t)void 0!==t[r]&&void 0===e[r]&&(e[r]=t[r])})),e}function g(e,t,r){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)if(d.call(e,n)){var a=e[n];t.call(r,a,n,e)&&i.push(a)}return i}function v(e){var t=e;try{t=decodeURI(e)}catch(r){t=e}return t}function _(){var e,t={},r=navigator.userAgent.toLowerCase();return(e=r.match(/ qq\/([\d.]+)/))?t.qqBuildinBrowser=Number(e[1].split(".")[0]):(e=r.match(/mqqbrowser\/([\d.]+)/))?t.qqBrowser=Number(e[1].split(".")[0]):(e=r.match(/opera.([\d.]+)/))?t.opera=Number(e[1].split(".")[0]):(e=r.match(/msie ([\d.]+)/))?t.ie=Number(e[1].split(".")[0]):(e=r.match(/edge.([\d.]+)/))?t.edge=Number(e[1].split(".")[0]):(e=r.match(/firefox\/([\d.]+)/))?t.firefox=Number(e[1].split(".")[0]):(e=r.match(/chrome\/([\d.]+)/))?t.chrome=Number(e[1].split(".")[0]):(e=r.match(/version\/([\d.]+).*safari/))?t.safari=Number(e[1].match(/^\d*.\d*/)):(e=r.match(/trident\/([\d.]+)/))&&(t.ie=11),t}function m(e){return R(e)?v(e=J(e)):v(location.href)}function b(e){({visibleHandler:E(e.visible)?e.visible:function(){},hiddenHandler:E(e.hidden)?e.hidden:function(){},visibilityChange:null,hidden:null,isSupport:function(){return void 0!==document[this.hidden]},init:function(){void 0!==document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):void 0!==document.mozHidden?(this.hidden="mozHidden",this.visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),this.listen()},listen:function(){if(this.isSupport()){var e=this;Oe(document,this.visibilityChange,(function(){document[e.hidden]?e.hiddenHandler():e.visibleHandler()}),!0)}else Oe(window,"focus",this.visibleHandler),Oe(window,"blur",this.hiddenHandler)}}).init()}function y(e,t){var r=document.createElement("Script");r.setAttribute("charset","UTF-8"),r.type="text/javascript",r.onload=r.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(t(),r.onload=r.onreadystatechange=null)},r.onerror=function(){console.log("warlocksdk load script error"),r.onerror=null},r.src=e,document.getElementsByTagName("head")[0].appendChild(r)}var w={get:function(e){for(var t=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var n=r[i];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return null},set:function(e,t,r,i,n){var a,o="",s="",u="";if(r=null!==(a=r)&&void 0!==a?a:73e3,i){var l=ne(location.href);"url解析失败"===l&&(l=""),o=l?"; domain="+l:""}if(0!==r){var c=new Date;"s"===String(r).slice(-1)?c.setTime(c.getTime()+1e3*Number(String(r).slice(0,-1))):c.setTime(c.getTime()+24*r*60*60*1e3),s="; expires="+c.toUTCString()}n&&(u="; SameSite=None; Secure"),document.cookie=e+"="+encodeURIComponent(t)+s+"; path=/"+o+u},remove:function(e,t){t=void 0===t?Ge.para.cross_subdomain:t,w.set(e,"",-1,t)},getCookieName:function(e){return"wljssdk_cross_"+e},getNewUser:function(){return null!==this.get("warlock_is_new_user")||null!==this.get(this.getCookieName("new_user"))},isSupport:function(e,t){e=e||"cookie_support_test",t=t||"1";var r=this;return navigator.cookieEnabled&&(r.set(e,t),r.get(e)===t&&(r.remove(e),!0))}},k={get:function(e){return window.localStorage&&window.localStorage.getItem(e)},parse:function(e){var t;try{t=JSON.parse(k.get(e))||null}catch(e){l.log("parse localStorage failed")}return t},set:function(e,t){try{return window.localStorage.setItem(e,t),!0}catch(e){return l.log("localStorage is not support"),!1}},remove:function(e){window.localStorage.removeItem(e)},isSupport:function(){var e=!0;try{var t="__local_storage_support__",r="testIsSupportStorage";k.set(t,r),k.get(t)!==r&&(e=!1),k.remove(t)}catch(t){e=!1}return e}},S={isSupport:function(){var e=!0,t="__session_storage_support__";try{sessionStorage&&sessionStorage.setItem?(sessionStorage.setItem(t,"testIsSupportStorage"),sessionStorage.removeItem(t),e=!0):e=!1}catch(t){e=!1}return e}};function O(e){var t=e;try{t=decodeURIComponent(e)}catch(r){t=e}return t}function P(e,t){return e.hasAttribute?e.hasAttribute(t):e.attributes?!(!e.attributes[t]||!e.attributes[t].specified):void 0}function T(e,t){if("string"==typeof t)return P(e,t);if(L(t)){for(var r=!1,i=0;i<t.length;i++){if(P(e,t[i])){r=!0;break}}return r}}function j(e,t){var r=e.indexOf;if(r)return r.call(e,t);for(var i=0;i<e.length;i++)if(t===e[i])return i;return-1}function N(e){for(var t={},r=(e=e||"").substring(1).split("&"),i=0;i<r.length;i++){var n=r[i].indexOf("=");if(-1!==n){var a=r[i].substring(0,n),o=r[i].substring(n+1);a=O(a),o=O(o),t[a]=o}}return t}function x(e){return!(!e||1!==e.nodeType)}function C(e){return void 0===e}function L(e){return Array.isArray&&E(L)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function E(e){if(!e)return!1;var t=Object.prototype.toString.call(e);return"[object Function]"==t||"[object AsyncFunction]"==t}function D(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)}function I(e){return"[object Number]"==Object.prototype.toString.call(e)&&/[\d\.]+/.test(String(e))}function R(e){return"[object String]"==Object.prototype.toString.call(e)}function A(e){if(R(e)){var t=J(e);return"undefined"!==t&&null!=t&&""!==t&&0!==t.length}return!1}function U(e){try{JSON.parse(e)}catch(e){return!1}return!0}function q(e){return"[object Date]"==Object.prototype.toString.call(e)}function H(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())}function M(e){return"[object Boolean]"==Object.prototype.toString.call(e)}function V(e){if(D(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}function F(t){if("object"===e(t)&&t.$option){var r=t.$option;return delete t.$option,r}return{}}function K(e){return D(e)?(f(e,(function(t,r){if(L(t)){var i=[];f(t,(function(e){R(e)?i.push(e):l.log('您的数据-",\n            '.concat(r,",\n            ").concat(t,',\n            "的数组里的值必须是字符串,已经将其删除'))})),0!==i.length?e[r]=i:(delete e[r],l.log("已经删除空的数组"))}R(t)||I(t)||q(t)||M(t)||L(t)||E(t)||"$option"===r||(l.log('您的数据-", '.concat(r,", ").concat(t,', "-格式不满足要求，我们已经将其删除')),delete e[r])})),e):e}function J(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function X(){return Date.now&&E(Date.now)?Date.now():(new Date).getTime()}function W(){return void 0!==window.XMLHttpRequest&&("withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest)}function z(e){(D(e)||L(e))&&f(e,(function(t,r){D(t)||L(t)?z(e[r]):q(t)&&(e[r]=H(t))}))}function $(e){D(e)&&f(["distinct_id","events"],(function(t){t in e&&l.log("您的属性- "+t+"是保留字段，请避免其作为属性名")}))}function B(e){var t=["ele_selector"];D(e)&&f(e,(function(r,i){var n,a;D(r)?B(e[i]):R(r)&&(e[i]=(n=r,a=j(t,i)>-1?1024:Ge.para.max_string_length,n.length>a?(l.log("字符串长度超过限制，已经做截取--"+n),n.slice(0,a)):n))}))}function G(){return"undefined"!=typeof navigator&&"function"==typeof navigator.sendBeacon}var Y,Q=(Y=(new Date).getTime(),function(e){return Math.ceil((Y=(9301*Y+49297)%233280)/233280*e)});function Z(){if("function"==typeof Uint32Array){var e="";if("undefined"!=typeof crypto?e=crypto:"undefined"!=typeof msCrypto&&(e=msCrypto),D(e)&&e.getRandomValues){var t=new Uint32Array(1);return e.getRandomValues(t)[0]/Math.pow(2,32)}}return Q(1e19)/1e19}function ee(e){var t=null;if(!e)return t;try{t=JSON.parse(e)}catch(e){}return t}function te(e){for(var t,r=[],i={},n=0;n<e.length;n++)(t=e[n])in i||(i[t]=!0,r.push(t));return r}var re={regChecks:{regName:/^((?!^distinct_id|^events|^\$|^_)[a-zA-Z_][a-zA-Z\d-_]{0,99})$/i},checkPropertiesKey:function(e){var t=this,r=!0;return f(e,(function(e,i){t.regChecks.regName.test(i)||(r=!1)})),r},check:function(e,t){return"string"==typeof this[e]?this[this[e]](t):this[e](t)},properties:function(e){return K(e),!e||(D(e)?(this.checkPropertiesKey(e)||l.log("自定义属性名需要是合法的变量名，不能以数字、下划线开头，且只包含：大小写字母、数字、下划线，不能是distinct_id、events"),!0):(l.log("properties可以没有，但有的话必须是对象"),!0))},propertiesMust:function(e){return K(e),void 0===e||!D(e)||V(e)?(l.log("properties必须是对象且有值"),!0):(this.checkPropertiesKey(e)||l.log("自定义属性名需要是合法的变量名，不能以数字、下划线开头，且只包含：大小写字母、数字、下划线，不能是distinct_id、events"),!0)},event:function(e){return R(e)&&this.regChecks.regName.test(e)||l.log("请检查参数格式，eventName 必须是字符串，自定义属性名需要是合法的变量名，不能以数字、下划线开头，且只包含：大小写字母、数字、下划线，不能是distinct_id、events"),!0},test_id:"str",group_id:"str",distinct_id:function(e){return!(!R(e)||!/^.{1,255}$/.test(e))||(l.log("distinct_id必须是不能为空，且小于255位的字符串"),!1)}};function ie(e){for(var t in e)if(!re.check(t,e[t]))return!1;return!0}function ne(t){var r=Ge.para.current_domain;switch(e(r)){case"function":var i=r();return""===i||""===J(i)?"url解析失败":-1!==i.indexOf(".")?i:"url解析失败";case"string":return""===r||""===J(r)?"url解析失败":-1!==r.indexOf(".")?r:"url解析失败";default:var n=ae();return""===t||""===n?"url解析失败":n}}function ae(e){var t=(e=e||window.location.hostname).split(".");if(L(t)&&t.length>=2&&!/^(\d+\.)+\d+$/.test(e))for(var r="."+t.splice(t.length-1,1);t.length>0;)if(r="."+t.splice(t.length-1,1)+r,document.cookie="warlock_domain_test=true; path=/; domain="+r,-1!==document.cookie.indexOf("warlock_domain_test=true")){var i=new Date;return i.setTime(i.getTime()-1e3),document.cookie="warlock_domain_test=true; expires="+i.toUTCString()+"; path=/; domain="+r,r}return""}function oe(e){var t,r={},i=["hash","host","hostname","href","origin","password","pathname","port","protocol","search","username"];if("function"==typeof window.URL&&function(){try{return"http://modernizr.com/"===new URL("http://modernizr.com/").href}catch(e){return!1}}())(r=new URL(e)).searchParams||(r.searchParams=(t=N(r.search),{get:function(e){return t[e]}}));else{if(!1===/^https?:\/\/.+/.test(e))throw"Invalid URL";var n=document.createElement("a");n.href=e;for(var a=i.length-1;a>=0;a--){var o=i[a];r[o]=n[o]}r.hostname&&"string"==typeof r.pathname&&0!==r.pathname.indexOf("/")&&(r.pathname="/"+r.pathname),r.searchParams=function(){var e=N(r.search);return{get:function(t){return e[t]}}}()}return r}function se(e,t){return R(e=e||document.referrer)?(0!==(e=v(e=J(e))).indexOf("https://www.baidu.com/")||t||(e=e.split("?")[0]),R(e=e.slice(0,Ge.para.max_referrer_string_length))?e:""):"取值异常_referrer异常_"+String(e)}function ue(e,t){t&&"string"==typeof t||(t="hostname解析异常");var r=null;try{r=oe(e).hostname}catch(e){l.log("getHostname传入的url参数不合法！")}return r||t}function le(){function e(e,t){for(var r=0;r<e.length;r++)if(-1!==t.split("?")[0].indexOf(e[r]))return!0}var t=Ge.para.source_type.search,r=Ge.para.source_type.social,i=document.referrer||"";return pe.pageProp.url?e(t,i)?"自然搜索流量":e(r,i)?"社交网站流量":""===i?"直接流量":"引荐流量":"获取url异常"}function ce(e,t){e=e||document.referrer;var r=Ge.para.source_type.keyword;if(document&&R(e)){if(0===e.indexOf("http")){var i=function(e){var t=ue(e);if(!t||"hostname解析异常"===t)return"";var r={baidu:[/^.*\.baidu\.com$/],bing:[/^.*\.bing\.com$/],google:[/^www\.google\.com$/,/^www\.google\.com\.[a-z]{2}$/,/^www\.google\.[a-z]{2}$/],sm:[/^m\.sm\.cn$/],so:[/^.+\.so\.com$/],sogou:[/^.*\.sogou\.com$/],yahoo:[/^.*\.yahoo\.com$/]};for(var i in r)for(var n=r[i],a=0,o=n.length;a<o;a++)if(n[a].test(t))return i;return"未知搜索引擎"}(e),n=fe(e);if(V(n))return"未取到值";var a=null;for(var o in r)if(i===o&&D(n))if(L(a=r[o]))for(var s=0;s<a.length;s++){var u=n[a[s]];if(u)return t?{active:u}:u}else if(n[a])return t?{active:n[a]}:n[a];return"未取到值"}return""===e?"未取到值_直接打开":"未取到值_非http的url"}return"取值异常_referrer异常_"+String(e)}function de(e){return""===(e=e||document.referrer)||ae(ue(e))!==ae()}function fe(e){var t={},r=e.split("?")[1]||"";return r&&(t=N("?"+r)),t}var pe={initPage:function(){var e=se(),t=m(),r=ne(t);this.pageProp={referrer:e,referrer_host:e?ue(e):"",url:t,url_host:ue(t,"url_host取值异常"),url_domain:r}},pageProp:{},properties:function(){var e=window.innerHeight||document.documentElement.clientHeight||document.body&&document.body.clientHeight||0,t=window.innerWidth||document.documentElement.clientWidth||document.body&&document.body.clientWidth||0;return{timezone_offset:(new Date).getTimezoneOffset(),screen_height:Number(screen.height)||0,screen_width:Number(screen.width)||0,viewport_height:e,viewport_width:t}},currentProps:{},data:{last_page_url:""},register:function(e){p(pe.currentProps,e)}};function he(e,t){if(R(t)&&"input"===t.toLowerCase())return r=e,i=Ge.para.heatmap&&E(Ge.para.heatmap.collect_input)&&Ge.para.heatmap.collect_input(r),("button"===r.type||"submit"===r.type||i)&&r.value||"";var r,i,n="";return e.textContent?n=J(e.textContent):e.innerText&&(n=J(e.innerText)),n&&(n=n.replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)),n||""}function ge(e){var t={};if(!x(e))return t;var r=e.tagName.toLowerCase();t.ele_type=r,t.ele_name=e.getAttribute("name"),t.ele_id=e.getAttribute("id"),t.ele_class_name=R(e.className)?e.className:null,t.ele_target_url=e.getAttribute("href"),t.ele_content=he(e,r);for(var i,n={},a=e.attributes,o=0;o<a.length;o++){var s=a[o].nodeName;["id","class","data-warlock-click","name"].indexOf(s)<0&&(n[s]=a[o].nodeValue)}return t.ele_attributes=JSON.stringify(n),i={},f(t,(function(e,t){null!=e&&(i[t]=e)})),(t=i).page_url=m(),Ge.para.page_title&&(t.page_title=document.title),t.viewport_width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,t}function ve(e){return(e=J(e))&&("://"===e.slice(0,3)?e=location.protocol.slice(0,-1)+e:"//"===e.slice(0,2)?e=location.protocol+e:"http"!==e.slice(0,4)&&(e="")),e}var _e,me=(_e=function(){for(var e=X(),t=0;e==X();)t++;return e.toString(16)+t.toString(16)},function(){var e=String(screen.height*screen.width);e=e&&/\d{5,}/.test(e)?e.toString(16):String(31242*Z()).replace(".","").slice(0,8);var t=_e()+"-"+Z().toString(16).replace(".","")+"-"+function(){var e,t,r=navigator.userAgent,i=[],n=0;function a(e,t){var r,n=0;for(r=0;r<t.length;r++)n|=i[r]<<8*r;return e^n}for(e=0;e<r.length;e++)t=r.charCodeAt(e),i.unshift(255&t),i.length>=4&&(n=a(n,i),i=[]);return i.length>0&&(n=a(n,i)),n.toString(16)}()+"-"+e+"-"+_e();return t||(String(Z())+String(Z())+String(Z())).slice(2,15)});function be(e){var t,r=location.href,i=window.history.pushState,n=window.history.replaceState;E(window.history.pushState)&&(window.history.pushState=function(){i.apply(window.history,arguments),e(r),r=location.href}),E(window.history.replaceState)&&(window.history.replaceState=function(){n.apply(window.history,arguments),e(r),r=location.href}),t=window.document.documentHashMode?"hashchange":i?"popstate":"hashchange",Oe(window,t,(function(){e(r),r=location.href}))}function ye(t,r,i){var n=null;if((t=t||{}).ele&&(n=t.ele),t.event&&(n=t.target?t.target:t.event.target),i=i||{},!n||"object"!==e(n))return!1;if(!n.href||/^javascript/.test(n.href)||n.target||n.download||n.onclick)return Ge.track(r,i),!1;function a(e){e.stopPropagation(),e.preventDefault();var t=!1;function a(){t||(t=!0,location.href=n.href)}setTimeout(a,1e3),Ge.track(r,i,a)}t.event&&a(t.event),t.ele&&Oe(t.ele,"click",(function(e){a(e)}))}function we(e){return new Se(e)}var ke=function(e,t){for(var r=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&r.push(e);return r},Se=function(){return n((function e(t){i(this,e),Object.defineProperty(this,"ele",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ele=t}),[{key:"addClass",value:function(e){return-1===(" "+this.ele.className+" ").indexOf(" "+e+" ")&&(this.ele.className=this.ele.className+(""===this.ele.className?"":" ")+e),this}},{key:"removeClass",value:function(e){var t=" "+this.ele.className+" ";return-1!==t.indexOf(" "+e+" ")&&(this.ele.className=t.replace(" "+e+" "," ").slice(1,-1)),this}},{key:"hasClass",value:function(e){return-1!==(" "+this.ele.className+" ").indexOf(" "+e+" ")}},{key:"attr",value:function(e,t){return"string"==typeof e&&C(t)?this.ele.getAttribute(e):("string"==typeof e&&(t=String(t),this.ele.setAttribute(e,t)),this)}},{key:"offset",value:function(){try{var e=this.ele.getBoundingClientRect(),t=this.ele.ownerDocument.documentElement;return{top:e.top+window.pageYOffset-t.clientTop,left:e.left+window.pageXOffset-t.clientLeft}}catch(e){return{top:0,left:0}}}},{key:"getSize",value:function(){if(!window.getComputedStyle)return{width:this.ele.offsetWidth,height:this.ele.offsetHeight};try{var e=this.ele.getBoundingClientRect();return{width:e.width,height:e.height}}catch(e){return{width:0,height:0}}}},{key:"getStyle",value:function(e){return this.ele.currentStyle?this.ele.currentStyle[e]:null===(t=this.ele.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(this.ele,null).getPropertyValue(e);var t}},{key:"wrap",value:function(e){var t=document.createElement(e);return this.ele.parentNode.insertBefore(t,this.ele),t.appendChild(this.ele),we(t)}},{key:"getCssStyle",value:function(e){var t=this.ele.style.getPropertyValue(e);if(t)return t;var r=null;if("function"==typeof window.getMatchedCSSRules&&(r=window.getMatchedCSSRules(this.ele)),!r||!L(r))return null;for(var i=r.length-1;i>=0;i--){if(t=r[i].style.getPropertyValue(e))return t}}},{key:"sibling",value:function(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}},{key:"next",value:function(){return this.sibling(this.ele,"nextSibling")}},{key:"prev",value:function(){return this.sibling(this.ele,"previousSibling")}},{key:"siblings",value:function(){return ke((this.ele.parentNode||{}).firstChild,this.ele)}},{key:"children",value:function(){return ke(this.ele.firstChild)}},{key:"parent",value:function(){var e=this.ele.parentNode;return e=e&&11!==e.nodeType?e:null,we(e)}},{key:"getSameTypeSiblings",value:function(){var e=this.ele,t=e.parentNode,r=e.tagName.toLowerCase(),i=[];if(t)for(var n=0;n<t.children.length;n++){var a=t.children[n];1===a.nodeType&&a.tagName.toLowerCase()===r&&i.push(t.children[n])}return i}},{key:"getParents",value:function(){try{var e=this.ele;if(!x(e))return[];var t=[e];if(null===e||null===e.parentElement)return[];for(;null!==e.parentElement;)e=e.parentElement,t.push(e);return t}catch(e){return[]}}}])}();function Oe(e,t,r,i){function n(e){return e&&(e.preventDefault=n.preventDefault,e.stopPropagation=n.stopPropagation,e._getPath=n._getPath),e}n._getPath=function(){return this.path||this.composedPath&&this.composedPath()||we(this.target).getParents()},n.preventDefault=function(){this.returnValue=!1},n.stopPropagation=function(){this.cancelBubble=!0};(function(e,t,r){if(void 0===i&&"click"===t&&(i=!0),e&&e.addEventListener)e.addEventListener(t,(function(e){e._getPath=n._getPath,r.call(this,e)}),i);else{var a="on"+t,o=e[a];e[a]=function(e,t,r,i){var a=function(a){if(a=a||n(window.event)){a.target=a.srcElement||a.target;var o,s,u=!0;return"function"==typeof r&&(o=r(a)),s=t.call(e,a),"beforeunload"!==i?(!1!==o&&!1!==s||(u=!1),u):void 0}};return a}(e,r,o,t)}}).call(null,e,t,r)}function Pe(e){window.addEventListener("ajaxReadyStateChange",e)}function Te(e){e.log=function(){l.log(arguments)},e.warn=function(){l.warn(arguments)},e.error=function(){l.error(arguments)}}function je(e){function t(e){if(!e)return"";try{return JSON.parse(e)}catch(e){return{}}}e.timeout=e.timeout||2e4,e.credentials=void 0===e.credentials||e.credentials;var r=function(e){if(e)return void 0!==window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:null;if(void 0!==window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){l.log(e)}}}(e.cors);if(!r)return!1;e.type||(e.type=e.data?"POST":"GET");var i=(e=p({success:function(){},error:function(){}},e)).success,n=e.error,a=null;e.success=function(e){i(e),a&&(clearTimeout(a),a=null)},e.error=function(e){n(e),a&&(clearTimeout(a),a=null)},a=setTimeout((function(){!function(){try{D(r)&&r.abort&&r.abort()}catch(e){l.log(e)}a&&(clearTimeout(a),a=null,e.error&&e.error(),r.onreadystatechange=null)}()}),e.timeout),"undefined"!=typeof XDomainRequest&&r instanceof XDomainRequest&&(r.onload=function(){e.success&&e.success(t(r.responseText),r.status),r.onreadystatechange=null},r.onerror=function(){e.error&&e.error(t(r.responseText),r.status),r.onreadystatechange=null}),r.onreadystatechange=function(){try{4==r.readyState&&(r.status>=200&&r.status<300||304==r.status?e.success(t(r.responseText),r.status):e.error(t(r.responseText),r.status),r.onreadystatechange=null)}catch(e){r.onreadystatechange=null}},r.open(e.type,e.url,!0);try{e.credentials&&(r.withCredentials=!0),D(e.header)&&f(e.header,(function(e,t){r.setRequestHeader&&r.setRequestHeader(t,e)})),e.data&&(e.cors||r.setRequestHeader&&r.setRequestHeader("X-Requested-With","XMLHttpRequest"),"application/json"===e.contentType?r.setRequestHeader&&r.setRequestHeader("Content-type","application/json; charset=UTF-8"):r.setRequestHeader&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"))}catch(e){l.log(e)}r.send(e.data||null)}var Ne=Object.freeze({__proto__:null,DomElementInfo:Se,UUID:me,_URL:oe,_decodeURI:v,_decodeURIComponent:O,_localStorage:k,_sessionStorage:S,addAjaxEvent:Pe,addEvent:Oe,addHashEvent:function(e){var t="pushState"in window.history?"popstate":"hashchange";Oe(window,t,e)},addSinglePageEvent:be,ajax:je,check:ie,cookie:w,coverExtend:h,createPlugin:function(e,t,r){return function(e,t,r){if(t&&(e.name=t),r&&e.init){var i=e.init;e.init=function(t,n){if(Te(e),t.readyState&&t.readyState.state>=3||!t.sdkEvents)return a();function a(){i.call(e,t,n)}t.sdkEvents.on(r,a)}}}(e,t,r),e.plugin_version="1.0.0",e},each:f,extend:p,filter:g,filterReservedProperties:$,formatDate:H,getCookieTopLevelDomain:ae,getCurrentDomain:ne,getEleInfo:ge,getElementContent:he,getHostname:ue,getKeywordFromReferrer:ce,getQueryParam:function(e,t){var r=oe(e),i=r.searchParams.get(t)||"";if(!i){var n=r.hash;if(n)i=fe(n)[t]||""}return i},getQueryParamsFromUrl:fe,getRandom:Z,getReferrer:se,getSourceFromReferrer:le,getUA:_,getURL:m,getURLSearchParams:N,hasAttribute:P,hasAttributes:T,indexOf:j,isArray:L,isBoolean:M,isDate:q,isElement:x,isEmptyObject:V,isFunction:E,isHttpUrl:function(e){return"string"==typeof e&&!1!==/^https?:\/\/.+/.test(e)},isJSONString:U,isNormalString:A,isNumber:I,isObject:D,isReferralTraffic:de,isString:R,isSupportBeaconSend:G,isSupportCors:W,isUndefined:C,listenPageState:b,loadScript:y,now:X,optimizeServerUrl:ve,pageInfo:pe,ry:we,safeJSONParse:ee,searchConfigData:F,searchObjDate:z,searchObjString:B,strip_wl_properties:K,throttle:function(e,t,r){var i,n,a,o=null,s=0;r||(r={});var u=function(){s=!1===r.leading?0:X(),o=null,a=e.apply(i,n),o||(i=n=null)};return function(){var l=X();s||!1!==r.leading||(s=l);var c=t-(l-s);return i=this,n=arguments,c<=0||c>t?(o&&(clearTimeout(o),o=null),s=l,a=e.apply(i,n),o||(i=n=null)):o||!1===r.trailing||(o=setTimeout(u,c)),a}},trackLink:ye,trim:J,unique:te,wrapLogFn:Te});var xe=function(){return n((function e(t){i(this,e),Object.defineProperty(this,"callback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server_url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callback=t.callback,this.server_url=t.server_url,this.data=t.data}),[{key:"start",value:function(){var e=this,t=X();je({url:this.server_url,type:"POST",data:this.data,contentType:"application/json",credentials:Ge.para.credentials,timeout:Ge.para.datasend_timeout,cors:!0,success:function(r,i){Ge.events.emit("sendSuccess",{status:String(i),resText:r,type:"ajax_single",timeout_config:Ge.para.datasend_timeout,request_timeout:X()-t,data:e.data}),e.end()},error:function(r,i){Ge.events.emit("sendFail",{status:String(i),resText:r,type:"ajax_single",timeout_config:Ge.para.datasend_timeout,request_timeout:X()-t,data:e.data}),e.end()}})}},{key:"end",value:function(){this.callback&&this.callback()}}])}(),Ce=function(){return n((function e(t){i(this,e),Object.defineProperty(this,"callback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server_url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"img",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callback=t.callback,this.img=document.createElement("img"),this.img.width=1,this.img.height=1,Ge.para.img_use_crossorigin&&(this.img.crossOrigin="anonymous"),this.data=t.data,this.server_url=function(e,t){var r=ee(t),i=[];f(r,(function(e,t){L(e)&&(e=JSON.stringify(e)),i.push("".concat(t,"=").concat(encodeURIComponent(e)))}));var n=i.join("&");return-1!==e.indexOf("?")?e+"&"+n:e+"?"+n}(t.server_url,t.data)}),[{key:"start",value:function(){var e=this;Ge.para.ignore_oom&&(this.img.onload=function(){this.onload=null,this.onerror=null,this.onabort=null,e.end()},this.img.onerror=function(){this.onload=null,this.onerror=null,this.onabort=null,e.end()},this.img.onabort=function(){this.onload=null,this.onerror=null,this.onabort=null,e.end()}),this.img.src=this.server_url}},{key:"end",value:function(){this.callback&&this.callback();var e=this;setTimeout((function(){e.lastClear&&e.lastClear()}),Ge.para.datasend_timeout-Ge.para.callback_timeout)}},{key:"lastClear",value:function(){void 0!==_().ie?this.img.src="about:blank":this.img.src=""}}])}(),Le=function(){return n((function e(t){i(this,e),Object.defineProperty(this,"callback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server_url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callback=t.callback,this.server_url=t.server_url,this.data=t.data}),[{key:"start",value:function(){var t=this;"object"===("undefined"==typeof navigator?"undefined":e(navigator))&&"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(this.server_url,this.data),setTimeout((function(){t.end()}),40)}},{key:"end",value:function(){this.callback&&this.callback()}}])}(),Ee=function(){return n((function e(t,r){i(this,e),Object.defineProperty(this,"lockGetPrefix",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lockSetPrefix",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lockGetPrefix=t||"lock-get-prefix",this.lockSetPrefix=r||"lock-set-prefix"}),[{key:"get",value:function(e,t,r,i){if(!e)throw new Error("key is must");t=t||1e4,r=r||1e3,i=i||function(){};var n=this.lockGetPrefix+e,a=k.get(n),o=String(Z());if(a&&(a=ee(a)||{randomNum:0,expireTime:0}).expireTime>X())return i(null);k.set(n,JSON.stringify({randomNum:o,expireTime:X()+t})),setTimeout((function(){(a=ee(k.get(n))||{randomNum:0,expireTime:0})&&a.randomNum===o?(i(k.get(e)),k.remove(e),k.remove(n)):i(null)}),r)}},{key:"set",value:function(e,t,r,i,n){if(!e||!t)throw new Error("key and val is must");r=r||1e4,i=i||1e3,n=n||function(){};var a=this.lockSetPrefix+e,o=k.get(a),s=String(Z());if(o&&(o=ee(o)||{randomNum:0,expireTime:0}).expireTime>X())return n({status:"fail",reason:"This key is locked"});k.set(a,JSON.stringify({randomNum:s,expireTime:X()+r})),setTimeout((function(){(o=ee(k.get(a))||{randomNum:0,expireTime:0}).randomNum===s?k.set(e,t)&&n({status:"success"}):n({status:"fail",reason:"This key is locked"})}),i)}}])}(),De="wlwebjssdk-",Ie="tab-wlwebjssdk-",Re=function(){return n((function e(){i(this,e),Object.defineProperty(this,"tabKey",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"serverUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendTimeStamp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hasTabStorage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sendTimeStamp=0,this.timer=null,this.serverUrl="",this.hasTabStorage=!1}),[{key:"batchInterval",value:function(){""===this.serverUrl&&this.getServerUrl(),this.hasTabStorage||(this.generateTabStorage(),this.hasTabStorage=!0);var e=this;e.timer=setTimeout((function(){e.updateExpireTime(),e.recycle(),e.send(),clearTimeout(e.timer),e.batchInterval()}),Ge.para.batch_send.send_interval)}},{key:"getServerUrl",value:function(){if(!(R(Ge.para.server_url)&&""!==Ge.para.server_url||L(Ge.para.server_url)&&Ge.para.server_url.length))return l.log("当前 server_url 为空或不正确，只在控制台打印日志，network 中不会发数据，请配置正确的 server_url！");this.serverUrl=L(Ge.para.server_url)?Ge.para.server_url[0]:Ge.para.server_url}},{key:"send",value:function(){if(!(this.sendTimeStamp&&X()-this.sendTimeStamp<Ge.para.batch_send.datasend_timeout)){var e=k.get(this.tabKey);if(e){var t=te((e=ee(e)||this.generateTabStorageVal()).data);if(t.length){this.sendTimeStamp=X();for(var r=[],i=0;i<t.length;i++){var n=Ge.store.readObjectVal(t[i]);n&&r.push(n)}var a=r[0];if(a){a._ts=X();for(var o=1;o<r.length;o++){var s=r[o];a.events.push(s.events[0])}this.request(JSON.stringify(a),e.data)}}}}}},{key:"request",value:function(e,t){var r=this,i=Ge.para.server_url,n=X();je({url:i,type:"POST",data:e,contentType:"application/json",credentials:!0,timeout:Ge.para.batch_send.datasend_timeout,cors:!0,success:function(i,a){Ge.events.emit("sendSuccess",{status:String(a),resText:i,type:"ajax_batch",timeout_config:Ge.para.batch_send.datasend_timeout,request_timeout:X()-n,data:e}),r.remove(t),r.sendTimeStamp=0},error:function(t,i){Ge.events.emit("sendFail",{status:String(i),resText:t,type:"ajax_batch",timeout_config:Ge.para.batch_send.datasend_timeout,request_timeout:X()-n,data:e}),r.sendTimeStamp=0}})}},{key:"updateExpireTime",value:function(){var e=k.get(this.tabKey);e&&((e=ee(e)||this.generateTabStorageVal()).expireTime=X()+2*Ge.para.batch_send.send_interval,e.serverUrl=this.serverUrl,k.set(this.tabKey,JSON.stringify(e)))}},{key:"remove",value:function(e){var t=k.get(this.tabKey);if(t){for(var r=(ee(t)||this.generateTabStorageVal()).data,i=0;i<e.length;i++){var n=j(r,e[i]);n>-1&&r.splice(n,1),k.remove(e[i])}r=te(r),k.set(this.tabKey,JSON.stringify(this.generateTabStorageVal(r)))}}},{key:"add",value:function(e){var t=De+String(Z()),r=k.get(this.tabKey);if(null===r?(this.tabKey=Ie+String(Z()),r=this.generateTabStorageVal()):r=ee(r)||this.generateTabStorageVal(),r.data.push(t),r.expireTime=X()+2*Ge.para.batch_send.send_interval,k.set(this.tabKey,JSON.stringify(r)),Ge.store.saveObjectVal(t,e),e.events&&e.events[0]){var i=e.events[0].event;"PageView"!==i&&"Login"!==i||this.sendImmediately()}}},{key:"generateTabStorage",value:function(){this.tabKey=Ie+String(Z()),k.set(this.tabKey,JSON.stringify(this.generateTabStorageVal()))}},{key:"generateTabStorageVal",value:function(e){return{data:e=e||[],expireTime:X()+2*Ge.para.batch_send.send_interval,serverUrl:this.serverUrl}}},{key:"sendImmediately",value:function(){this.send()}},{key:"recycle",value:function(){for(var e,t,r,i=this,n={},a="wljssdk-lock-get-",o=function(){var o=localStorage.key(s),u=i;if(0===o.indexOf(Ie)){for(e=ee(k.get(o))||i.generateTabStorageVal(),t=0;t<e.data.length;t++)n[e.data[t]]=!0;o!==u.tabKey&&X()>e.expireTime&&i.serverUrl===e.serverUrl&&new Ee(a).get(o,1e4,1e3,(function(e){if(e){null===k.get(u.tabKey)&&u.generateTabStorage();var t=ee(e)||u.generateTabStorageVal(),r=ee(k.get(u.tabKey))||u.generateTabStorageVal();r.data=te(r.data.concat(t.data)),k.set(u.tabKey,JSON.stringify(r))}}))}else 0===o.indexOf(a)&&(r=ee(k.get(o))||{expireTime:0},X()-r.expireTime>1e4&&k.remove(o))},s=0;s<localStorage.length;s++)o();for(var u=0;u<localStorage.length;u++){var l=localStorage.key(u);0!==l.indexOf(De)||n[l]||k.remove(l)}}}])}(),Ae=new Re,Ue={getRealtimeInstance:function(e){return this.getSend(e)},getSend:function(e){switch(this.getSendType(e)){case"beacon":return new Le(e);case"ajax":default:return new xe(e);case"image":return new Ce(e)}},getSendType:function(e){var t=["beacon","ajax","image"],r=t[0];return e.config&&j(t,e.config.send_type)>-1?r=e.config.send_type:Ge.para.send_type&&(r=Ge.para.send_type),"beacon"===r&&!1===G()&&(r="ajax"),"ajax"===r&&!1===W()&&(r="image"),r}},qe={getSendCall:function(e,t,r){if(Ge.readyState.state<3)return l.log("初始化没有完成"),!1;var i=e,n={data:i,config:t,callback:r};return!("function"==typeof Ge.para.server_filter&&!Ge.para.server_filter(i))&&(Ge.events.emit("send",i),Ge.para.batch_send&&localStorage.length<200?(l.log(i,"batchSend"),Ae.add(n.data),!1):(this.prepareServerUrl(n),void l.log(i,"sendData")))},prepareServerUrl:function(e){this.sendCall(e,Ge.para.server_url,e.callback)},sendCall:function(e,t,r){var i=e.data,n={server_url:t,data:JSON.stringify(i),callback:r,config:e.config};this.realtimeSend(n)},realtimeSend:function(e){Ue.getRealtimeInstance(e).start()}};var He={checkIsAddSign:function(e){"track"===e.event_type&&(e.properties.is_first_day=this.getNewUser())},is_first_visit_time:!1,checkIsFirstTime:function(e){},getNewUser:function(){if(Ge.para.use_cookie)return w.getNewUser();var e=w.getCookieName("new_user"),t=k.get(e);if(t){var r=ee(t);return!!r&&(!((new Date).getTime()>r.expireTime)||(k.remove(e),!1))}return!1},storeInitCheck:function(){if(Ge.is_first_visitor){var e=new Date,t={h:23-e.getHours(),m:59-e.getMinutes(),s:59-e.getSeconds()};Ge.para.use_cookie?w.set(w.getCookieName("new_user"),"1",3600*t.h+60*t.m+t.s+"s"):(e.setTime(e.getTime()+1e3*(3600*t.h+60*t.m+t.s)),k.set(w.getCookieName("new_user"),JSON.stringify({value:1,expireTime:e.getTime()}))),this.is_first_visit_time=!0}else this.getNewUser()||(this.checkIsAddSign=function(e){"track"===e.event_type&&(e.properties.is_first_day=!1)})},checkIsFirstLatest:function(){var e,t=pe.pageProp.url_domain,r={};""===t&&(t="url解析失败"),f(Ge.para,(function(e,i){if(-1===i.indexOf("latest_"))return!1;if(i=i.slice(7),e){if("url解析失败"===t)r["latest_"+i]="url的domain解析失败";else if(de(document.referrer))switch(i){case"traffic_source_type":r.latest_traffic_source_type=le();break;case"referrer":r.latest_referrer=pe.pageProp.referrer;break;case"search_keyword":r.latest_search_keyword=ce();break;case"landing_page":r.latest_landing_page=location.href}}else Ge.store._state.props&&"latest_"+i in Ge.store._state.props&&delete Ge.store._state.props["latest_"+i]})),ie({properties:e=r})?Me.setProps(e):l.log("register输入的参数有误")}},Me={requests:[],_state:{distinct_id:"",first_id:"",props:{},identities:{}},getProps:function(){return this._state.props||{}},getOriginDistinctId:function(){return this._state.distinct_id},getOriginUnionId:function(e){var t={},r=(e=e||this._state)._first_id||e.first_id,i=e._distinct_id||e.distinct_id;return r&&i?(t.login_id=i,t.anonymous_id=r):t.anonymous_id=i,t},getDistinctId:function(){var e=this.getUnionId();return e.login_id||e.anonymous_id},getUnionId:function(e){return this.getOriginUnionId(e)},getFirstId:function(){return this._state.first_id},toState:function(t){var r=null;if(null!=t&&U(t))if(r=JSON.parse(t),this._state=p(r),r.distinct_id){if("object"===e(r.props)){for(var i in r.props)"string"==typeof r.props[i]&&(r.props[i]=r.props[i].slice(0,Ge.para.max_referrer_string_length));this.save()}}else this.set("distinct_id",me());else this.set("distinct_id",me())},setOnce:function(e,t){e in this._state||this.set(e,t)},set:function(e,t){this._state=this._state||{};var r=this._state.distinct_id;this._state[e]=t,this.save(),"distinct_id"===e&&r&&u.emit("changeDistinctId",t)},change:function(e,t){this._state["_"+e]=t},setProps:function(e,t){var r={};for(var i in r=t?e:p(this._state.props||{},e))"string"==typeof r[i]&&(r[i]=r[i].slice(0,Ge.para.max_referrer_string_length));this.set("props",r)},setPropsOnce:function(e){var t=this._state.props||{};h(t,e),this.set("props",t)},save:function(){var e=JSON.parse(JSON.stringify(this._state)),t=JSON.stringify(e);Ge.para.use_cookie?w.set(this.getCookieName(),t,365,Ge.para.cross_subdomain):k.set(this.getCookieName(),t)},getCookieName:function(){return"warlockjssdkcross"+Ge.para.sdk_id},init:function(){var e=me();this.initStorage();var t=null;null===(t=Ge.para.use_cookie?w.get(this.getCookieName()):k.get(this.getCookieName()))?(Ge.is_first_visitor=!0,this.set("distinct_id",e)):(U(t)&&JSON.parse(t).distinct_id||(Ge.is_first_visitor=!0),this.toState(t)),He.storeInitCheck(),He.checkIsFirstLatest()},initStorage:function(){if(!Ge.para.use_cookie){var e=k.get(this.getCookieName()),t=w.get(this.getCookieName());if(!e)if(t)if(k.set(this.getCookieName(),t),w.get(w.getCookieName("new_user"))){var r=new Date,i={h:23-r.getHours(),m:59-r.getMinutes(),s:59-r.getSeconds()};r.setTime(r.getTime()+1e3*(3600*i.h+60*i.m+i.s)),k.set(w.getCookieName("new_user"),JSON.stringify({value:1,expireTime:r.getTime()}))}t&&(w.remove(this.getCookieName()),w.remove(this.getCookieName(),!0),w.remove(w.getCookieName("new_user")),w.remove(w.getCookieName("new_user"),!0))}},saveObjectVal:function(e,t){R(t)||(t=JSON.stringify(t)),k.set(e,t)},readObjectVal:function(e){var t=k.get(e);return t?ee(t):null}};var Ve={buildData:function(e){var t,r={distinct_id:Me.getDistinctId(),properties:{event_ts:(new Date).getTime(),event_no:(new Date).getTime()}};return D(e)&&D(e.properties)&&V(e.properties)&&e.properties.lib_detail&&(r._lib.lib_detail=e.properties.lib_detail,delete e.properties.lib_detail),D(e.properties)&&!V(e.properties)&&p(r.properties,e.properties),delete e.properties,p(r.properties,Ge.store.getUnionId(),e),r.event_type=e.event_type,r.event=e.event,e.event_type&&"profile"===e.event_type.slice(0,7)||(r.properties=p({},pe.properties(),Me.getProps(),pe.currentProps,r.properties),Ge.para.latest_referrer&&!R(r.properties.latest_referrer)&&(r.properties.latest_referrer="取值异常"),Ge.para.latest_search_keyword&&!R(r.properties.latest_search_keyword)&&(r.properties.latest_search_keyword="取值异常"),Ge.para.latest_traffic_source_type&&!R(r.properties.latest_traffic_source_type)&&(r.properties.latest_traffic_source_type="取值异常"),Ge.para.latest_landing_page&&!R(r.properties.latest_landing_page)&&(r.properties.latest_landing_page="取值异常")),r.properties.time&&q(r.properties.time)&&(r.time=1*r.properties.time,delete r.properties.time),D(t=r)&&f(t,(function(e,r){if(E(e))try{t[r]=e(),E(t[r])&&(l.log("您的属性- "+r+" 格式不满足要求，我们已经将其删除"),delete t[r])}catch(e){delete t[r],l.log("您的属性- "+r+" 抛出了异常，我们已经将其删除")}})),function(e){var t=e.properties;D(t)?(K(t),$(t),B(t)):"properties"in e&&(e.properties={}),z(e)}(r),He.checkIsAddSign(r),function(e){var t=!e.event_type||"profile"!==e.event_type.slice(0,7),r="取值异常";D(e.properties)&&(e.properties.first_referrer&&(e.properties.first_referrer_host=ue(e.properties.first_referrer,r)),t&&("referrer"in e.properties&&(e.properties.referrer_host=""===e.properties.referrer?"":ue(e.properties.referrer,r)),Ge.para.latest_referrer&&Ge.para.latest_referrer_host&&(e.properties.latest_referrer_host=""===e.properties.latest_referrer?"":ue(e.properties.latest_referrer,r))))}(r),function(e){var t=!e.event_type||"profile"!==e.event_type.slice(0,7);t&&Ge.para.page_url&&void 0===e.properties.page_url&&(e.properties.page_url=m()),t&&Ge.para.page_title&&void 0===e.properties.page_title&&(e.properties.page_title=document.title)}(r),r.properties.app_ver=Ge.para.app_ver,r._reqid=me(),r._topic=Ge.para.token,r._v=Ge._v,r._lib=Ge._lib,r._lib_version=Ge._lib_version,r.app_name=Ge.para.app_name,delete r.event_type,delete r.event,this.filterProperties(r),r},filterProperties:function(e){E(Ge.para.filter_properties)&&e.properties&&Ge.para.filter_properties(e.properties,e)},sendData:function(e,t){var r=F(e.properties);e._ts=X(),e.properties&&(e.events=[e.properties],delete e.properties),Ge.sendState.getSendCall(e,r,t)}},Fe={check:ie,send:function(e,t){var r=Ve.buildData(e);Ve.sendData(r,t)},sendMult:function(e,t){for(var r=[],i=0;i<e.length;i++){var n=e[i],a=Ve.buildData(n);r.push(a)}var o=r[0];if(o){o.events=[],u.properties&&(o.events.push(u.properties),delete u.properties);for(var s=1;s<r.length;s++){var u=r[s];o.events.push(u.properties)}Ve.sendData(o,t)}}},Ke={isCollectTag:function(e){return!this.isIgnoreTag(e)&&("a"===e||"button"===e||"input"===e||"textarea"===e)},isIgnoreTag:function(e){if(Ge.para.auto_track_ignore_elements){if(M(Ge.para.auto_track_ignore_elements))return!0;if(L(Ge.para.auto_track_ignore_elements)&&Ge.para.auto_track_ignore_elements.indexOf(e)>-1)return!0}return!1},getAttributeNames:function(e){var t=[];if(e.getAttributeNames)return e.getAttributeNames();for(var r=0;r<e.attributes.length;r++)t.push(e.attributes[r].name);return t},getDomIndex:function(e){if(!e.parentNode)return-1;for(var t=0,r=e.tagName,i=e.parentNode.children,n=0;n<i.length;n++)if(i[n].tagName===r){if(e===i[n])return t;t++}return-1},selector:function(e){var t=e.parentNode&&9==e.parentNode.nodeType?-1:this.getDomIndex(e);return e.getAttribute&&e.getAttribute("id")?"#"+e.getAttribute("id"):e.tagName.toLowerCase()+(~t?":nth-of-type("+(t+1)+")":"")},getDomSelector:function(e,t){var r;if(!e||!e.parentNode||!e.parentNode.children)return!1;t=t&&t.join?t:[];var i=e.nodeName.toLowerCase();return e&&"body"!==i&&1==e.nodeType?(t.unshift(this.selector(e)),e.getAttribute&&e.getAttribute("id")&&"not_use_id"!==(null===(r=Ge.para.heatmap)||void 0===r?void 0:r.element_selector)?t.join(" > "):this.getDomSelector(e.parentNode,t)):(t.unshift("body"),t.join(" > "))},start:function(e,t,r,i,n){var a=D(i)?i:{},o=E(n)?n:E(i)?i:void 0;if(Ge.para.auto_track_filter&&E(Ge.para.auto_track_filter)&&!Ge.para.auto_track_filter(t))return!1;var s=ge(t);if(Ge.para.element_selector){var u=this.getDomSelector(t);s.ele_selector=u||""}for(var l="custom-prop-",c=this.getAttributeNames(t),d=0;d<c.length;d++)c[d].startsWith(l)&&(s[c[d].substr(12)]=t.getAttribute(c[d]));if(null!==e&&(s.page_x=Math.round(e.pageX),s.page_y=Math.round(e.pageY)),E(Ge.para.auto_track_property_extend)){var f=Ge.para.auto_track_property_extend(t);D(f)&&(s=p(s,f))}s=p(s,a),"a"===r&&Ge.para.heatmap&&!0===Ge.para.heatmap.isTrackLink?ye({event:e,target:t},"WebClick",s):Ge.track("WebClick",s,o)},hasElement:function(t){var r=t._getPath();if(L(r)&&r.length>0)for(var i=0;i<r.length;i++)if("object"===e(r[i])&&1===r[i].nodeType&&(r[i].tagName&&this.isCollectTag(r[i].tagName.toLowerCase())||T(r[i],Ge.para.auto_track_attr)))return r[i];return!1},initAutoTrack:function(){Ge.listenSinglePage(),this.initHeatmap(),Ge.listenAjaxEvent()},initHeatmap:function(){var t=this;Ge.para.auto_track_web_click&&Oe(document,"click",(function(r){var i=r||window.event;if(!i)return!1;var n=i.target||i.srcElement;if("object"!==e(n))return!1;if("string"!=typeof n.tagName)return!1;var a=n.tagName.toLowerCase();if("body"===a.toLowerCase()||"html"===a.toLowerCase())return!1;if(!n||!n.parentNode||!n.parentNode.children)return!1;if(A(n.className)&&Ge.para.auto_track_elements_class&&L(Ge.para.auto_track_elements_class))for(var o=n.className.split(" "),s=0;s<o.length;s++)if(Ge.para.auto_track_elements_class.indexOf(o[s])>=0)return void t.start(i,n,a);if(Ge.para.auto_track_elements_id&&L(Ge.para.auto_track_elements_id)&&Ge.para.auto_track_elements_id.indexOf(n.getAttribute("id"))>=0)t.start(i,n,a);else if(Ge.para.auto_track_elements&&L(Ge.para.auto_track_elements)&&Ge.para.auto_track_elements.indexOf(a)>=0&&!t.isIgnoreTag(a))t.start(i,n,a);else if(t.isCollectTag(a)||T(n,Ge.para.auto_track_attr))t.start(i,n,a);else{var u=t.hasElement(r);u&&t.start(i,u,u.tagName.toLowerCase())}}))}},Je={autoTrackIsUsed:!1,isReady:function(e){e()},trackWebClick:function(t,r,i){"object"===e(t)&&t.tagName&&Ke.start(null,t,t.tagName.toLowerCase(),r,i)},trackPageView:function(e,t){var r=this.autoTrackIsUsed?pe.pageProp.url:pe.pageProp.referrer;function i(e,t){Ge.track("PageView",p({page_referrer:r,page_url:location.href,page_title:document.title},e),t),r=location.href}e=D(e)?e:{},Ge.is_first_visitor&&(Ge.setOnceProfile({first_visit_time:new Date,first_referrer:se(),first_browser_language:navigator.language||"取值异常",first_browser_charset:"string"==typeof document.charset?document.charset.toUpperCase():"取值异常",first_traffic_source_type:le(),first_search_keyword:ce()}),Ge.is_first_visitor=!1),i(e,t),this.trackPageView=i},autoTrackPageView:function(e,t){e=D(e)?e:{},Ge.is_first_visitor&&(Ge.setOnceProfile({first_visit_time:new Date,first_referrer:se(),first_browser_language:navigator.language||"取值异常",first_browser_charset:"string"==typeof document.charset?document.charset.toUpperCase():"取值异常",first_traffic_source_type:le(),first_search_keyword:ce()}),Ge.is_first_visitor=!1),Ge.track("PageView",p({page_referrer:pe.data.last_page_url||pe.pageProp.referrer,page_url:location.href,page_title:document.title},e),t),this.autoTrackIsUsed=!0,pe.data.last_page_url=location.href}},Xe=function(){return n((function e(){i(this,e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PageLeave"}),Object.defineProperty(this,"wl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"page_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"page_show_status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"current_page_url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"option",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"max_duration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.wl=null,this.page_id=null,this.start_time=+new Date,this.page_show_status=!0,this.timer=null,this.url=location.href,this.current_page_url=document.referrer,this.option={},this.max_duration=432e3}),[{key:"init",value:function(e,t){e?(this.wl=e,t&&(this.option=t),this.page_id=Number(String(Z()).slice(2,5)+String(Z()).slice(2,4)+String((new Date).getTime()).slice(-4)),this.addEventListener(),!0===document.hidden&&(this.page_show_status=!1),this.log("PageLeave初始化完毕")):this.log("请传入warlock实例")}},{key:"addEventListener",value:function(){this.addPageStartListener(),this.addPageSwitchListener(),this.addSinglePageListener(),this.addPageEndListener()}},{key:"pageStartHandler",value:function(){this.start_time=X(),"visible"===document.visibilityState?this.page_show_status=!0:this.page_show_status=!1,this.url=location.href}},{key:"pageEndHandler",value:function(){if(this.page_show_status){var e=this.getPageLeaveProperties();this.page_show_status=!1,this.wl.track("WebPageLeave",e)}}},{key:"getPageLeaveProperties",value:function(){var e=(+new Date-this.start_time)/1e3;(isNaN(e)||e<0||e>this.max_duration)&&(e=0),e=Number(e.toFixed(3));var t=se(this.current_page_url),r=document.documentElement&&document.documentElement.scrollTop||window.pageYOffset||document.body&&document.body.scrollTop||0;r=Math.round(r)||0;var i={page_title:document.title,page_url:location.href,page_referrer:t,viewport_position:r};return 0!==e&&(i.event_duration=e),i=p(i,this.option.custom_props)}},{key:"addPageStartListener",value:function(){var e=this;"onpageshow"in window&&Oe(window,"pageshow",(function(){e.pageStartHandler()}))}},{key:"addPageEndListener",value:function(){var e=this;"onpagehide"in window?Oe(window,"pagehide",(function(){e.pageEndHandler()})):Oe(window,"unload",(function(){e.pageEndHandler()}))}},{key:"addPageSwitchListener",value:function(){var e=this;b({visible:function(){e.pageStartHandler()},hidden:function(){e.url=location.href,e.pageEndHandler()}})}},{key:"addSinglePageListener",value:function(){var e=this;this.wl.events.on("single-page-switch",(function(t){t!==location.href&&(e.url=t,e.pageEndHandler(),e.current_page_url=e.url,e.pageStartHandler())}))}},{key:"log",value:function(e){l.log(e)}}])}();function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function ze(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?We(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):We(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}for(var $e={latest_traffic_source_type:!1,latest_search_keyword:!1,latest_referrer:!1,latest_referrer_host:!1,latest_landing_page:!1,page_url:!0,page_title:!0,element_selector:!0,ajax_response:!1,_v:"1.0.0",token:"",app_ver:"",app_name:"",server_url:"https://logapi.zhipin.com/dap/api/json",max_referrer_string_length:200,max_string_length:500,cross_subdomain:!1,show_log:!1,sdk_id:"",auto_track_page_view:!1,auto_track_web_click:!1,auto_track_ajax:!1,track_ka:!1,batch_send:!1,source_type:{},callback_timeout:200,datasend_timeout:8e3,ignore_oom:!0,credentials:!0,env:"prod"},Be=function(){return n((function e(){i(this,e),Object.defineProperty(this,"_",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_t",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"is_first_visitor",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_v",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_lib",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_lib_version",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"modules",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"readyState",{enumerable:!0,configurable:!0,writable:!0,value:{state:0,historyState:[],stateType:{1:"1-init未开始",2:"2-init开始",3:"3-store完成",4:"4-sdk初始化完成"},getState:function(){return this.historyState.join("\n")},setState:function(e){String(e)in this.stateType&&(this.state=e),this.historyState.push(this.stateType[e])}}}),Object.defineProperty(this,"para",{enumerable:!0,configurable:!0,writable:!0,value:ze({},$e)}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:Me}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new s}),Object.defineProperty(this,"sdkEvents",{enumerable:!0,configurable:!0,writable:!0,value:new s}),Object.defineProperty(this,"sendState",{enumerable:!0,configurable:!0,writable:!0,value:qe}),Object.defineProperty(this,"logger",{enumerable:!0,configurable:!0,writable:!0,value:l}),this._=p({},Ne),l.log("初始化完成aaa")}),[{key:"init",value:function(e){return this.sdkEvents.emit("beforeInit"),!(this.readyState&&this.readyState.state&&this.readyState.state>=2)&&(e&&e.token&&e.app_name?(this.initSystemEvent(),this.setInitVar(),this.readyState.setState(2),this.initPara(e),this.sdkEvents.emit("initPara"),this.sdkEvents.emit("init"),this.detectMode(),this.sdkEvents.emit("afterInit"),void this.sdkEvents.emit("ready")):(console.error("WARLOCK SDK INIT FAILED，[token, app_name] ONE OR MORE DO NOT EXIST"),!1))}},{key:"setInitVar",value:function(){this._t=this._t||X(),this.is_first_visitor=!1,this._v="1.0.0",this._lib="js";try{this._lib_version="2.1.5"}catch(e){this._lib_version="1.0.0"}}},{key:"initPara",value:function(t){this.para=p({},$e,t);var r={datasend_timeout:6e3,send_interval:2e3,one_send_max_length:20};!1!==this.para.batch_send&&k.isSupport()&&W()&&"object"===("undefined"==typeof localStorage?"undefined":e(localStorage))?!0===this.para.batch_send?this.para.batch_send=p({},r):"object"===e(this.para.batch_send)&&(this.para.batch_send=p({},r,this.para.batch_send)):this.para.batch_send=!1,this.initParaSourceType(),this.para.heatmap&&!D(this.para.heatmap)&&(this.para.heatmap={});var i=L(this.para.auto_track_attr)?g(this.para.auto_track_attr,(function(e){return e&&"string"==typeof e})):[];i.push("data-warlock-click"),this.para.auto_track_attr=i,this.para.server_url=ve(this.para.server_url),!0===this.para.noCache?this.para.noCache="?"+X():this.para.noCache="",this.para.callback_timeout>this.para.datasend_timeout&&(this.para.datasend_timeout=this.para.callback_timeout)}},{key:"initParaSourceType",value:function(){var t=["www.baidu.","m.baidu.","m.sm.cn","so.com","sogou.com","youdao.com","google.","yahoo.com/","bing.com/","ask.com/"],r=["weibo.com","renren.com","kaixin001.com","douban.com","qzone.qq.com","zhihu.com","tieba.baidu.com","weixin.qq.com"],i={baidu:["wd","word","kw","keyword"],google:"q",bing:"q",yahoo:"p",sogou:["query","keyword"],so:"q",sm:"q"};"object"===e(this.para.source_type)&&(this.para.source_type.search=L(this.para.source_type.search)?this.para.source_type.search.concat(t):t,this.para.source_type.social=L(this.para.source_type.social)?this.para.source_type.social.concat(r):r,this.para.source_type.keyword=D(this.para.source_type.keyword)?p(i,this.para.source_type.keyword):i)}},{key:"detectMode",value:function(){this.trackMode()}},{key:"trackMode",value:function(){this.readyState.setState(3),pe.initPage(),Ge.para.batch_send&&Ae.batchInterval(),Ge.store.init(),Ge.readyState.setState(4),Ke.initAutoTrack()}},{key:"initSystemEvent",value:function(){var e=this;be((function(t){e.events.emit("single-page-switch",t)})),this.addKeyboardLinstener()}},{key:"listenSinglePage",value:function(e){this.para.auto_track_page_view&&this.events.on("single-page-switch",(function(t){var r=function(r){if(r=r||{},t!==location.href){pe.pageProp.referrer=m(t);var i=p({page_url:m(),page_referrer:m(t)},r);E(e)?e(i):Ge.quick&&Ge.quick("autoTrackPageView",i)}};if("boolean"==typeof Ge.para.auto_track_page_view)r();else if("function"==typeof Ge.para.auto_track_page_view){var i=Ge.para.auto_track_page_view();D(i)?r(i):!0===i&&r()}}))}},{key:"listenAjaxEvent",value:function(){this.para.auto_track_ajax&&Pe((function(e){4===e.detail.readyState&&200===e.detail.status&&-1===e.detail.responseURL.indexOf("/dap/api/json")&&Ge.track("Ajax",p({request_url:e.detail.responseURL,request_duration:(new Date).getTime()-e.detail.start_time}))}))}},{key:"addKeyboardLinstener",value:function(){document.addEventListener("keydown",(function(e){e.ctrlKey&&(e.altKey||e.metaKey)&&e.shiftKey&&"KeyB"===e.code&&(console.log("Control + Alt/Option + Shift + B 被按下"),Ge.loadDetectDom())})),"1"===k.get("wk_sdk_detect_dom_flag")&&Ge.loadDetectDom()}},{key:"loadDetectDom",value:function(){Ge.loadingScript||(window.warlock_sdk_detect_dom?window.warlock_sdk_detect_dom():(Ge.loadingScript=!0,y(k.get("wk_sdk_dom_url")||"https://unpkg.weizhipin.com/@datastar/warlock-detect-dom@latest/dist/index.js",(function(){Ge.loadingScript=!1}))))}},{key:"setOnceProfile",value:function(e,t){Fe.check({propertiesMust:e})&&Fe.send({event_type:"profile_set_once",event:"PageView",properties:e},t)}},{key:"extendTrackProps",value:function(e){Fe.check({properties:e})?p(pe.currentProps,e):l.log("register输入的参数有误")}},{key:"register",value:function(e){Fe.check({properties:e})?Me.setProps(e):l.log("register输入的参数有误")}},{key:"registerOnce",value:function(e){Fe.check({properties:e})?Me.setPropsOnce(e):l.log("registerOnce输入的参数有误")}},{key:"anonymousId",value:function(e){"number"==typeof e&&(e=String(e));var t=Me.getFirstId();if(void 0===e){var r=me();t?Me.set("first_id",r):Me.set("distinct_id",r)}else Fe.check({distinct_id:e})?t?Me.set("first_id",e):Me.set("distinct_id",e):l.log("anonymousId的参数必须是字符串")}},{key:"login",value:function(e,t){if("number"==typeof e&&(e=String(e)),Fe.check({distinct_id:e})){var r=Me.getFirstId(),i=Me.getDistinctId();e!==i?(r||Me.set("first_id",i),Fe.check({distinct_id:e,event:"Login",properties:{}})&&(Me.set("distinct_id",e),Fe.send({event_type:"track_login",event:"Login",properties:{}},t))):t&&t()}else l.log("login的参数必须是字符串"),t&&t()}},{key:"logout",value:function(e){var t=Me.getFirstId();if(t)if(Me.set("first_id",""),!0===e){var r=me();Me.set("distinct_id",r)}else Me.set("distinct_id",t);else l.log("没有first_id，logout失败")}},{key:"track",value:function(e,t,r){Fe.check({event:e,properties:t})&&Fe.send({event_type:"track",event:e,properties:t},r)}},{key:"trackMult",value:function(e,t){if(e.length>0){for(var r=[],i=0;i<e.length;i++){var n=e[i],a=n.name,o=n.data;Fe.check({event:a,properties:o})&&r.push({event_type:"track",event:a,properties:o})}Fe.sendMult(r,t)}}},{key:"quick",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],n=t.slice(1);if("string"==typeof i&&Je[i])return Je[i].apply(Je,n);"function"==typeof i?i.apply(Ge,n):l.log("quick方法中没有这个功能"+t[0])}},{key:"use",value:function(e,t){if(R(e)||D(e)){var r;if(D(e)){var i=Ge.modules&&Ge.modules[e.name];i&&i!==e&&l.log(e.name+" is conflict with builtin plugin, and sdk uses builtin plugin."),r=i||e}if(R(e)&&D(Ge.modules)&&D(Ge.modules[e])&&(r=Ge.modules[e]),r&&E(r.init))return r.name||l.log("warning: invalid plugin, name required."),r.plugin_is_init||(!r.plugin_is_init&&r.init(Ge,t),r.plugin_is_init=!0,Ge.modules=Ge.modules||{},Ge.modules[r.name]=r),r;l.log("plugin is not found or plugin.init must be a function")}else l.log("must be string or object.")}}])}(),Ge=new Be,Ye=[new Xe],Qe=0;Qe<Ye.length;Qe++){var Ze=Ye[Qe];R(Ze.name)&&(Ge.modules[Ze.name]=Ze)}return"undefined"!=typeof window&&(window.Warlock=Ge),Ge}));
